<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <title>12.3 Input value conversion 6.x</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8"/>
    <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8"/>
    <script type="text/javascript">
function addJsClass() {
    var classes = document.body.className.split(" ");
    classes.push("js");
    document.body.className = classes.join(" ");
}
    </script>
</head>

<body class="body" onload="addJsClass();">
<div id="navigation">
    <ul>
        <li>
            <div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)">
                <a href="../../guide/index.html" class="button">Table of contents</a>

                <div id="nav-summary-childs" style="display:none;">
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter1.html"><strong>1</strong><span>Introduction</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/howToSource.html"><strong>2</strong><span>How to use the example code</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter2.html"><strong>3</strong><span>Why should I learn Wicket?</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter3.html"><strong>4</strong><span>Wicket says &ldquo;Hello world!&rdquo;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter4.html"><strong>5</strong><span>Wicket as page layout manager</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter5.html"><strong>6</strong><span>Keeping control over HTML</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter6.html"><strong>7</strong><span>Components lifecycle</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter7.html"><strong>8</strong><span>Page versioning and caching</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter8.html"><strong>9</strong><span>Under the hood of the request processing</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter9.html"><strong>10</strong><span>Wicket Links and URL generation</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter10.html"><strong>11</strong><span>Wicket models and forms</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter11.html"><strong>12</strong><span>Wicket forms in detail</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter12.html"><strong>13</strong><span>Displaying multiple items with repeaters</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter13.html"><strong>14</strong><span>Internationalization with Wicket</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter14.html"><strong>15</strong><span>Resource management with Wicket</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter15.html"><strong>16</strong><span>An example of integration with JavaScript</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter16.html"><strong>17</strong><span>Wicket advanced topics</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter17.html"><strong>18</strong><span>Working with AJAX</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter18.html"><strong>19</strong><span>Integration with enterprise containers</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter19.html"><strong>20</strong><span>Security with Wicket</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter20.html"><strong>21</strong><span>Test Driven Development with Wicket</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter21.html"><strong>22</strong><span>Test Driven Development with Wicket and Spring</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter22.html"><strong>23</strong><span>Wicket Best Practices</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter23.html"><strong>24</strong><span>Working with Maven (Appendix)</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter24.html"><strong>25</strong><span>Project WicketStuff (Appendix)</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter25.html"><strong>26</strong><span>Lost In Redirection With Apache Wicket (Appendix)</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter26.html"><strong>27</strong><span>Contributing to this guide (Appendix)</span></a>
                    </div>
                    
                </div>
            </div>
        </li>
        <li class="separator selected">
            <a id="ref-button" onclick="localToggle(); return false;" href="#">Quick Reference</a>
        </li>
    </ul>
</div>
<div id="header">
    <div class="images clearfix">
        
        <span id="logo"><a href="/" target="_blank"><img height="80px" src="http://wicket.apache.org/guide/img/apache-wicket.png"/></a></span>
        
        
        <span id="sponsor"><a href="http://www.apache.org/" target="_blank"><img height="60px" src="http://www.apache.org/images/asf_logo.gif"/></a></span>
        
    </div>
    <p>Free Online Guide for Apache Wicket framework</p>
</div>


<table id="colset" border="0" cellpadding="0" cellspacing="0">
    <tr>
        <td id="col1">
            <div id="main" class="corner-all">

                
                    <div class="toc-item prev-left"><a href="../../guide/chapter10.html">&lt;&lt; <strong>11</strong><span>Wicket models and forms</span></a></div>
                

                <span id='toggle-col1' class="toggle">(<a href="#" onclick="localToggle(); return false;">Quick Reference</a>)</span>

                
                    <div class="toc-item next-right"><a href="../../guide/chapter12.html"><strong>13</strong><span>Displaying multiple items with repeaters</span> >></a></div>
                


                <div class="project">
                    <h1>12.3 Input value conversion - Reference Documentation</h1>

                    <p><strong>Authors:</strong> Andrea Del Bene, Carsten Hufe, Christian Kroemer, Daniel Bartl, Paul Borș</p>

                    <p><strong>Version:</strong> 6.x</p>

                    
                </div>

                

                

<h2 id="chapter11_3">12.3 Input value conversion</h2>
<p class="paragraph"/>Working with Wicket we will rarely need to worry about conversion between input values (which are strings because the underlying HTTP protocol) and Java types because in most cases the default conversion mechanism will be smart enough to infer the type of the model object and perform the proper conversion. However, sometimes we may need to work under the hood of this mechanism to make it properly work or to perform custom conversions. That's why this paragraph will illustrate how to control input value conversion.<p class="paragraph"/>The component that is responsible for converting input is the FormComponent itself with its convertInput() method. In order to convert its input a FormComponent must know the type of its model object. This parameter can be explicitly set with method setType(Class&#60;?&#62; type):<p class="paragraph"/><div class="code"><pre>//<span class="java&#45;keyword">this</span> field must receive an integer value
TextField integerField = <span class="java&#45;keyword">new</span> TextField(<span class="java&#45;quote">"number"</span>, <span class="java&#45;keyword">new</span> Model()).setType(<span class="java&#45;object">Integer</span>.class));</pre></div><p class="paragraph"/>If no type has been provided, FormComponent will try to ask its model for this information. The PropertyModel and CompoundPropertyModel models can use reflection to get the type of object model. By default, if FormComponent can not obtain the type of its model object in any way, it will consider it as a simple String.<p class="paragraph"/>Once FormComponent has determined the type of model object, it can look up for a converter, which is the entity in charge of converting input to Java object and vice versa. Converters are instances of org.apache.wicket.util.convert.IConverter interface and are registered by our application class on start up.<p class="paragraph"/>To get a converter for a specific type we must call method getConverter(Class&#60;C&#62; type) on the interface IConverterLocator returned by Application's method getConverterLocator():<p class="paragraph"/><div class="code"><pre>//retrieve converter <span class="java&#45;keyword">for</span> <span class="java&#45;object">Boolean</span> type
Application.get().getConverterLocator().getConverter(<span class="java&#45;object">Boolean</span>.class);</pre></div><p class="paragraph"/><blockquote class="note">
Components which are subclasses of AbstractSingleSelectChoice don't follow the schema illustrated above to convert user input.<p class="paragraph"/>These kinds of components (like DropDownChoice and RadioChoice1) use their choice render and their collection of possible choices to perform input conversion.
</blockquote><p class="paragraph"/><h3>Creating custom application-scoped converters</h3><p class="paragraph"/>The default converter locator used by Wicket is org.apache.wicket.ConverterLocator. This class provides converters for the most common Java types. Here we can see the converters registered inside its constructor:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">public</span> ConverterLocator()
&#123;
	set(<span class="java&#45;object">Boolean</span>.TYPE, BooleanConverter.INSTANCE);
	set(<span class="java&#45;object">Boolean</span>.class, BooleanConverter.INSTANCE);
	set(<span class="java&#45;object">Byte</span>.TYPE, ByteConverter.INSTANCE);
	set(<span class="java&#45;object">Byte</span>.class, ByteConverter.INSTANCE);
	set(<span class="java&#45;object">Character</span>.TYPE, CharacterConverter.INSTANCE);
	set(<span class="java&#45;object">Character</span>.class, CharacterConverter.INSTANCE);
	set(<span class="java&#45;object">Double</span>.TYPE, DoubleConverter.INSTANCE);
	set(<span class="java&#45;object">Double</span>.class, DoubleConverter.INSTANCE);
	set(<span class="java&#45;object">Float</span>.TYPE, FloatConverter.INSTANCE);
	set(<span class="java&#45;object">Float</span>.class, FloatConverter.INSTANCE);
	set(<span class="java&#45;object">Integer</span>.TYPE, IntegerConverter.INSTANCE);
	set(<span class="java&#45;object">Integer</span>.class, IntegerConverter.INSTANCE);
	set(<span class="java&#45;object">Long</span>.TYPE, LongConverter.INSTANCE);
	set(<span class="java&#45;object">Long</span>.class, LongConverter.INSTANCE);
	set(<span class="java&#45;object">Short</span>.TYPE, ShortConverter.INSTANCE);
	set(<span class="java&#45;object">Short</span>.class, ShortConverter.INSTANCE);
	set(Date.class, <span class="java&#45;keyword">new</span> DateConverter());
	set(Calendar.class, <span class="java&#45;keyword">new</span> CalendarConverter());
	set(java.sql.Date.class, <span class="java&#45;keyword">new</span> SqlDateConverter());
	set(java.sql.Time.class, <span class="java&#45;keyword">new</span> SqlTimeConverter());
	set(java.sql.Timestamp.class, <span class="java&#45;keyword">new</span> SqlTimestampConverter());
	set(BigDecimal.class, <span class="java&#45;keyword">new</span> BigDecimalConverter());
&#125;</pre></div><p class="paragraph"/>If we want to add more converters to our application, we can override Application's method newConverterLocator which is used by application class to build its converter locator.<p class="paragraph"/>To illustrate how to implement custom converters and use them in our application, we will build a form with two text field: one to input a regular expression pattern and another one to input a string value that will be split with the given pattern.<p class="paragraph"/>The first text field will have an instance of class java.util.regex.Pattern as model object. The final page will look like this (the code of this example is from the CustomConverter project):<p class="paragraph"/><img border="0" class="center" src="../img/regex-form.png"></img><p class="paragraph"/>The conversion between Pattern and String is quite straightforward. The code of our custom converter is the following:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">public</span> class RegExpPatternConverter <span class="java&#45;keyword">implements</span> IConverter&#60;Pattern&#62; &#123;
	@Override
	<span class="java&#45;keyword">public</span> Pattern convertToObject(<span class="java&#45;object">String</span> value, Locale locale) &#123;
		<span class="java&#45;keyword">return</span> Pattern.compile(value);
	&#125;<p class="paragraph"/>	@Override
	<span class="java&#45;keyword">public</span> <span class="java&#45;object">String</span> convertToString(Pattern value, Locale locale) &#123;
		<span class="java&#45;keyword">return</span> value.toString();
	&#125;
&#125;</pre></div><p class="paragraph"/>Methods declared by interface IConverter take as input a Locale parameter in order to deal with locale-sensitive data and conversions. We will learn more about locales and internationalization in chapter 12.<p class="paragraph"/>Once we have implemented our custom converter, we must override method newConverterLocator() inside our application class and tell it to add our new converter to the default set:<p class="paragraph"/><div class="code"><pre>@Override
	<span class="java&#45;keyword">protected</span> IConverterLocator newConverterLocator() &#123;
		ConverterLocator defaultLocator = <span class="java&#45;keyword">new</span> ConverterLocator();<p class="paragraph"/>		defaultLocator.set(Pattern.class, <span class="java&#45;keyword">new</span> RegExpPatternConverter());<p class="paragraph"/>		<span class="java&#45;keyword">return</span> defaultLocator;
	&#125;</pre></div><p class="paragraph"/>Finally, in the home page of the project we build the form which displays (with a flash message) the tokens obtained splitting the string with the given pattern:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">public</span> class HomePage <span class="java&#45;keyword">extends</span> WebPage &#123;
    <span class="java&#45;keyword">private</span> Pattern regExpPatter;
    <span class="java&#45;keyword">private</span> <span class="java&#45;object">String</span> stringToSplit;<p class="paragraph"/>    <span class="java&#45;keyword">public</span> HomePage(<span class="java&#45;keyword">final</span> PageParameters parameters) &#123;		
    	TextField mail;
	TextField stringToSplitTxt;<p class="paragraph"/>    	Form form = <span class="java&#45;keyword">new</span> Form(<span class="java&#45;quote">"form"</span>)&#123;
			@Override
			<span class="java&#45;keyword">protected</span> void onSubmit() &#123;
				<span class="java&#45;keyword">super</span>.onSubmit();
				<span class="java&#45;object">String</span> messageResult = <span class="java&#45;quote">"Tokens <span class="java&#45;keyword">for</span> the given string and pattern:&#60;br/&#62;"</span>;
				<span class="java&#45;object">String</span>&#91;&#93; tokens = regExpPatter.split(stringToSplit);<p class="paragraph"/>				<span class="java&#45;keyword">for</span> (<span class="java&#45;object">String</span> token : tokens) &#123;
					messageResult += <span class="java&#45;quote">"&#45; "</span> + token + <span class="java&#45;quote">"&#60;br/&#62;"</span>;
				&#125;				
				success(messageResult);
		&#125;
	&#125;;<p class="paragraph"/>		form.setDefaultModel(<span class="java&#45;keyword">new</span> CompoundPropertyModel(<span class="java&#45;keyword">this</span>));
		form.add(mail = <span class="java&#45;keyword">new</span> TextField(<span class="java&#45;quote">"regExpPatter"</span>));
		form.add(stringToSplitTxt = <span class="java&#45;keyword">new</span> TextField(<span class="java&#45;quote">"stringToSplit"</span>));
		add(<span class="java&#45;keyword">new</span> FeedbackPanel(<span class="java&#45;quote">"feedbackMessage"</span>).setEscapeModelStrings(<span class="java&#45;keyword">false</span>));<p class="paragraph"/>		add(form);
    &#125;
&#125;</pre></div><p class="paragraph"/><blockquote class="note">
If the user input can not be converted to the target type, FormComponent will generate the default error message “The value of '${label}' is not a valid ${type}.”. The bundle key for this message is IConverter.
</blockquote>


                <div style="clear:both;margin-top:15px;"></div>
                
                    <div class="toc-item prev-left"><a href="../../guide/chapter10.html">&lt;&lt; <strong>11</strong><span>Wicket models and forms</span></a></div>
                
                    <div class="toc-item next-right"><a href="../../guide/chapter12.html"><strong>13</strong><span>Displaying multiple items with repeaters</span> >></a></div>
                
                <div style="clear:both"></div>
            </div>
        </td>
        <td id="col2">
            <div class="local clearfix">
                <div class="local-title">
                    <a href="../../guide/index.html" target="mainFrame">Quick Reference</a>
                    <span class="toggle">(<a href="#" onclick="localToggle(); return false;">hide</a>)</span>
                </div>
                <div class="menu">
                    
                </div>
            </div>
        </td>
    </tr>
</table>

<div id="footer">
    
Copyright &copy; 2013 — <a href="http://www.apache.org/" target="_blank">The Apache Software Foundation</a>

    
</div>

<script type="text/javascript" src="../js/docs.js"></script>

</body>
</html>
