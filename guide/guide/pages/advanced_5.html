<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <title>17.5 Generating HTML markup from code 6.x</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8"/>
    <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8"/>
    <script type="text/javascript">
function addJsClass() {
    var classes = document.body.className.split(" ");
    classes.push("js");
    document.body.className = classes.join(" ");
}
    </script>
</head>

<body class="body" onload="addJsClass();">
<div id="navigation">
    <ul>
        <li>
            <div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)">
                <a href="../../guide/index.html" class="button">Table of contents</a>

                <div id="nav-summary-childs" style="display:none;">
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/introduction.html"><strong>1</strong><span>Introduction</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/howToSource.html"><strong>2</strong><span>How to use the example code</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/whyLearn.html"><strong>3</strong><span>Why should I learn Wicket?</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/helloWorld.html"><strong>4</strong><span>Wicket says &ldquo;Hello world!&rdquo;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/layout.html"><strong>5</strong><span>Wicket as page layout manager</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/keepControl.html"><strong>6</strong><span>Keeping control over HTML</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/componentLifecycle.html"><strong>7</strong><span>Components lifecycle</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/versioningCaching.html"><strong>8</strong><span>Page versioning and caching</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/requestProcessing.html"><strong>9</strong><span>Under the hood of the request processing</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/urls.html"><strong>10</strong><span>Wicket Links and URL generation</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/modelsforms.html"><strong>11</strong><span>Wicket models and forms</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/forms2.html"><strong>12</strong><span>Wicket forms in detail</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/repeaters.html"><strong>13</strong><span>Displaying multiple items with repeaters</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/i18n.html"><strong>14</strong><span>Internationalization with Wicket</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/resources.html"><strong>15</strong><span>Resource management with Wicket</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/jsintegration.html"><strong>16</strong><span>An example of integration with JavaScript</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/advanced.html"><strong>17</strong><span>Wicket advanced topics</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/ajax.html"><strong>18</strong><span>Working with AJAX</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/jee.html"><strong>19</strong><span>Integration with enterprise containers</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/nativewebsockets.html"><strong>20</strong><span>Native WebSockets</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/security.html"><strong>21</strong><span>Security with Wicket</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/testing.html"><strong>22</strong><span>Test Driven Development with Wicket</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/testingspring.html"><strong>23</strong><span>Test Driven Development with Wicket and Spring</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/bestpractices.html"><strong>24</strong><span>Wicket Best Practices</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/internals.html"><strong>25</strong><span>Wicket Internals</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/maven.html"><strong>26</strong><span>Working with Maven (Appendix)</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/wicketstuff.html"><strong>27</strong><span>Project WicketStuff (Appendix)</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/redirects.html"><strong>28</strong><span>Lost In Redirection With Apache Wicket (Appendix)</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/contributing.html"><strong>29</strong><span>Contributing to this guide (Appendix)</span></a>
                    </div>
                    
                </div>
            </div>
        </li>
        <li class="separator selected">
            <a id="ref-button" onclick="localToggle(); return false;" href="#">Quick Reference</a>
        </li>
    </ul>
</div>
<div id="header">
    <div class="images clearfix">
        
        <span id="logo"><a href="/" target="_blank"><img height="80px" src="http://wicket.apache.org/guide/img/apache-wicket.png"/></a></span>
        
        
        <span id="sponsor"><a href="http://www.apache.org/" target="_blank"><img height="60px" src="http://wicket.apache.org/guide/img/asf_logo.gif"/></a></span>
        
    </div>
    <p>Free Online Guide for Apache Wicket framework</p>
</div>


<table id="colset" border="0" cellpadding="0" cellspacing="0">
    <tr>
        <td id="col1">
            <div id="main" class="corner-all">

                
                    <div class="toc-item prev-left"><a href="../../guide/jsintegration.html">&lt;&lt; <strong>16</strong><span>An example of integration with JavaScript</span></a></div>
                

                <span id='toggle-col1' class="toggle">(<a href="#" onclick="localToggle(); return false;">Quick Reference</a>)</span>

                
                    <div class="toc-item next-right"><a href="../../guide/ajax.html"><strong>18</strong><span>Working with AJAX</span> >></a></div>
                


                <div class="project">
                    <h1>17.5 Generating HTML markup from code - Reference Documentation</h1>

                    <p><strong>Authors:</strong> Andrea Del Bene, Martin Grigorov, Carsten Hufe, Christian Kroemer, Daniel Bartl, Paul Bor»ô</p>

                    <p><strong>Version:</strong> 6.x</p>

                    
                </div>

                

                

<h2 id="advanced_5">17.5 Generating HTML markup from code</h2>
<p class="paragraph"/>So far, as markup source for our pages/panels we have used a static markup file, no matter if it was inherited or directly associated to the component. Now we want to investigate a more complex use case where we want to dynamical generate the markup directly inside component code.<p class="paragraph"/>To become a markup producer, a component must simply implement interface <code>org.apache.wicket.markup.IMarkupResourceStreamProvider</code>. The only method defined in this interface is <code>getMarkupResourceStream(MarkupContainer, Class&#60;?&#62;)</code> which returns an utility interface called <code>IResourceStream</code> representing the actual markup.<p class="paragraph"/>In the following example we have a custom panel without a related markup file that generates a simple &#60;div&#62; tag as markup:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">public</span> class AutoMarkupGenPanel <span class="java&#45;keyword">extends</span> Panel <span class="java&#45;keyword">implements</span> IMarkupResourceStreamProvider &#123;
	<span class="java&#45;keyword">public</span> AutoMarkupGenPanel(<span class="java&#45;object">String</span> id, IModel&#60;?&#62; model) &#123;
		<span class="java&#45;keyword">super</span>(id, model);		
	&#125;<p class="paragraph"/>	@Override
	<span class="java&#45;keyword">public</span> IResourceStream getMarkupResourceStream(MarkupContainer container,
			<span class="java&#45;object">Class</span>&#60;?&#62; containerClass) &#123;
		<span class="java&#45;object">String</span> markup = <span class="java&#45;quote">"&#60;div&#62;Panel markup&#60;/div&#62;"</span>;
		StringResourceStream resourceStream = <span class="java&#45;keyword">new</span> StringResourceStream(markup);<p class="paragraph"/>		<span class="java&#45;keyword">return</span> resourceStream;
	&#125;
&#125;</pre></div><p class="paragraph"/>Class StringResourceStream is a resource stream that uses a String instance as backing object.<p class="paragraph"/><h3>Avoiding markup caching</h3><p class="paragraph"/>As we have seen in the previous paragraph, Wicket uses an internal cache for components markup. This can be a problem if our component dynamical generates its markup when it is rendered because once the markup has been cached, Wicket will always use the cached version for the specific component. To overwrite this default caching policy, a component can implement interface <code>IMarkupCacheKeyProvider</code>.<p class="paragraph"/>This interface defines method <code>getCacheKey(MarkupContainer, Class&#60;?&#62;)</code> which returns a string value representing the key used by Wicket to retrieve the markup of the component from the cache. If this value is null the markup will not be cached, allowing the component to display the last generated markup each time it is rendered:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">public</span> class NoCacheMarkupPanel <span class="java&#45;keyword">extends</span> Panel <span class="java&#45;keyword">implements</span> IMarkupCacheKeyProvider &#123;
	<span class="java&#45;keyword">public</span> NoCacheMarkupPanel(<span class="java&#45;object">String</span> id, IModel&#60;?&#62; model) &#123;
		<span class="java&#45;keyword">super</span>(id, model);		
	&#125;<p class="paragraph"/>	/&#42;&#42;
	&#42; Generate a dynamic HTML markup that changes every time
	&#42; the component is rendered
	&#42;/
	@Override
	<span class="java&#45;keyword">public</span> IResourceStream getMarkupResourceStream(MarkupContainer container,
			<span class="java&#45;object">Class</span>&#60;?&#62; containerClass) &#123;
		<span class="java&#45;object">String</span> markup = <span class="java&#45;quote">"&#60;div&#62;Panel with current nanotime: "</span> + <span class="java&#45;object">System</span>.nanoTime() +
				 <span class="java&#45;quote">"&#60;/div&#62;"</span>; 
		StringResourceStream resourceStream = <span class="java&#45;keyword">new</span> StringResourceStream(markup);<p class="paragraph"/>		<span class="java&#45;keyword">return</span> resourceStream;
	&#125;<p class="paragraph"/>	/&#42;&#42;
	&#42; Avoid markup caching <span class="java&#45;keyword">for</span> <span class="java&#45;keyword">this</span> component
	&#42;/
	@Override
	<span class="java&#45;keyword">public</span> <span class="java&#45;object">String</span> getCacheKey(MarkupContainer arg0, <span class="java&#45;object">Class</span>&#60;?&#62; arg1) &#123;
		<span class="java&#45;keyword">return</span> <span class="java&#45;keyword">null</span>;
	&#125;
&#125;</pre></div>


                <div style="clear:both;margin-top:15px;"></div>
                
                    <div class="toc-item prev-left"><a href="../../guide/jsintegration.html">&lt;&lt; <strong>16</strong><span>An example of integration with JavaScript</span></a></div>
                
                    <div class="toc-item next-right"><a href="../../guide/ajax.html"><strong>18</strong><span>Working with AJAX</span> >></a></div>
                
                <div style="clear:both"></div>
            </div>
        </td>
        <td id="col2">
            <div class="local clearfix">
                <div class="local-title">
                    <a href="../../guide/index.html" target="mainFrame">Quick Reference</a>
                    <span class="toggle">(<a href="#" onclick="localToggle(); return false;">hide</a>)</span>
                </div>
                <div class="menu">
                    
                </div>
            </div>
        </td>
    </tr>
</table>

<div id="footer">
    
Copyright &copy; 2013-2014 ‚Äî <a href="http://www.apache.org/" target="_blank">The Apache Software Foundation</a> 
                      ‚Äî <b style="color:#E8590A !important;">(Generated on: 2015-02-03)</b>

    
</div>

<script type="text/javascript" src="../js/docs.js"></script>

</body>
</html>
