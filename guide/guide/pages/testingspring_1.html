<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <title>23.1 Configuration of the runtime environment 6.x</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8"/>
    <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8"/>
    <script type="text/javascript">
function addJsClass() {
    var classes = document.body.className.split(" ");
    classes.push("js");
    document.body.className = classes.join(" ");
}
    </script>
</head>

<body class="body" onload="addJsClass();">
<div id="navigation">
    <ul>
        <li>
            <div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)">
                <a href="../../guide/index.html" class="button">Table of contents</a>

                <div id="nav-summary-childs" style="display:none;">
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/introduction.html"><strong>1</strong><span>Introduction</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/howToSource.html"><strong>2</strong><span>How to use the example code</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/whyLearn.html"><strong>3</strong><span>Why should I learn Wicket?</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/helloWorld.html"><strong>4</strong><span>Wicket says &ldquo;Hello world!&rdquo;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/layout.html"><strong>5</strong><span>Wicket as page layout manager</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/keepControl.html"><strong>6</strong><span>Keeping control over HTML</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/componentLifecycle.html"><strong>7</strong><span>Components lifecycle</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/versioningCaching.html"><strong>8</strong><span>Page versioning and caching</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/requestProcessing.html"><strong>9</strong><span>Under the hood of the request processing</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/urls.html"><strong>10</strong><span>Wicket Links and URL generation</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/modelsforms.html"><strong>11</strong><span>Wicket models and forms</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/forms2.html"><strong>12</strong><span>Wicket forms in detail</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/repeaters.html"><strong>13</strong><span>Displaying multiple items with repeaters</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/i18n.html"><strong>14</strong><span>Internationalization with Wicket</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/resources.html"><strong>15</strong><span>Resource management with Wicket</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/jsintegration.html"><strong>16</strong><span>An example of integration with JavaScript</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/advanced.html"><strong>17</strong><span>Wicket advanced topics</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/ajax.html"><strong>18</strong><span>Working with AJAX</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/jee.html"><strong>19</strong><span>Integration with enterprise containers</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/nativewebsockets.html"><strong>20</strong><span>Native WebSockets</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/security.html"><strong>21</strong><span>Security with Wicket</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/testing.html"><strong>22</strong><span>Test Driven Development with Wicket</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/testingspring.html"><strong>23</strong><span>Test Driven Development with Wicket and Spring</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/bestpractices.html"><strong>24</strong><span>Wicket Best Practices</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/internals.html"><strong>25</strong><span>Wicket Internals</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/maven.html"><strong>26</strong><span>Working with Maven (Appendix)</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/wicketstuff.html"><strong>27</strong><span>Project WicketStuff (Appendix)</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/redirects.html"><strong>28</strong><span>Lost In Redirection With Apache Wicket (Appendix)</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/contributing.html"><strong>29</strong><span>Contributing to this guide (Appendix)</span></a>
                    </div>
                    
                </div>
            </div>
        </li>
        <li class="separator selected">
            <a id="ref-button" onclick="localToggle(); return false;" href="#">Quick Reference</a>
        </li>
    </ul>
</div>
<div id="header">
    <div class="images clearfix">
        
        <span id="logo"><a href="/" target="_blank"><img height="80px" src="http://wicket.apache.org/guide/img/apache-wicket.png"/></a></span>
        
        
        <span id="sponsor"><a href="http://www.apache.org/" target="_blank"><img height="60px" src="http://wicket.apache.org/guide/img/asf_logo.gif"/></a></span>
        
    </div>
    <p>Free Online Guide for Apache Wicket framework</p>
</div>


<table id="colset" border="0" cellpadding="0" cellspacing="0">
    <tr>
        <td id="col1">
            <div id="main" class="corner-all">

                
                    <div class="toc-item prev-left"><a href="../../guide/testing.html">&lt;&lt; <strong>22</strong><span>Test Driven Development with Wicket</span></a></div>
                

                <span id='toggle-col1' class="toggle">(<a href="#" onclick="localToggle(); return false;">Quick Reference</a>)</span>

                
                    <div class="toc-item next-right"><a href="../../guide/bestpractices.html"><strong>24</strong><span>Wicket Best Practices</span> >></a></div>
                


                <div class="project">
                    <h1>23.1 Configuration of the runtime environment - Reference Documentation</h1>

                    <p><strong>Authors:</strong> Andrea Del Bene, Martin Grigorov, Carsten Hufe, Christian Kroemer, Daniel Bartl, Paul Borș</p>

                    <p><strong>Version:</strong> 6.x</p>

                    
                </div>

                

                

<h2 id="testingspring_1">23.1 Configuration of the runtime environment</h2>
<p class="paragraph"/>In order to get the Wicket framework up to speed when your server is up and running, you usually configure a <code>WicketFilter</code> instance in your web application deployment descriptor file (<code>web.xml</code>) while passing it a single init parameter called <code>applicationClassName</code> that points to your main implementation class extending <code>org.apache.wicket.protocol.http.WebApplication</code> where all of your application-wide settings and initialization requirements are dealt with:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;filter&#62;</span>
    <span class="xml&#45;tag">&#60;filter&#45;name&#62;</span>wicketfilter<span class="xml&#45;tag">&#60;/filter&#45;name&#62;</span>
    <span class="xml&#45;tag">&#60;filter&#45;class&#62;</span>org.apache.wicket.protocol.http.WicketFilter<span class="xml&#45;tag">&#60;/filter&#45;class&#62;</span>
    <span class="xml&#45;tag">&#60;init&#45;param&#62;</span>
        <span class="xml&#45;tag">&#60;param&#45;name&#62;</span>applicationClassName<span class="xml&#45;tag">&#60;/param&#45;name&#62;</span>
        <span class="xml&#45;tag">&#60;param&#45;value&#62;</span>com.comsysto.webapp.MyWebApplication<span class="xml&#45;tag">&#60;/param&#45;value&#62;</span>
    <span class="xml&#45;tag">&#60;/init&#45;param&#62;</span>
<span class="xml&#45;tag">&#60;/filter&#62;</span></pre></div><p class="paragraph"/>In case you want to get Wicket application up and running while leaving the application configuration and dependency injection issues to the Spring container, the configuration to be provided within the deployment descriptor looks slightly different though:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;web&#45;app&#62;</span>
    <span class="xml&#45;tag">&#60;filter&#62;</span>
        <span class="xml&#45;tag">&#60;filter&#45;name&#62;</span>wicketfilter<span class="xml&#45;tag">&#60;/filter&#45;name&#62;</span>
        <span class="xml&#45;tag">&#60;filter&#45;class&#62;</span>org.apache.wicket.protocol.http.WicketFilter<span class="xml&#45;tag">&#60;/filter&#45;class&#62;</span>
        <span class="xml&#45;tag">&#60;init&#45;param&#62;</span>
            <span class="xml&#45;tag">&#60;param&#45;name&#62;</span>applicationFactoryClassName<span class="xml&#45;tag">&#60;/param&#45;name&#62;</span>
            <span class="xml&#45;tag">&#60;param&#45;value&#62;</span>org.apache.wicket.spring.SpringWebApplicationFactory<span class="xml&#45;tag">&#60;/param&#45;value&#62;</span>
        <span class="xml&#45;tag">&#60;/init&#45;param&#62;</span>
    <span class="xml&#45;tag">&#60;/filter&#62;</span>
    <span class="xml&#45;tag">&#60;listener&#62;</span>
        <span class="xml&#45;tag">&#60;listener&#45;class&#62;</span>org.springframework.web.context.ContextLoaderListener<span class="xml&#45;tag">&#60;/listener&#45;class&#62;</span>
    <span class="xml&#45;tag">&#60;/listener&#62;</span>
    <span class="xml&#45;tag">&#60;context&#45;param&#62;</span>
        <span class="xml&#45;tag">&#60;param&#45;name&#62;</span>contextConfigLocation<span class="xml&#45;tag">&#60;param&#45;name&#62;</span>
        <span class="xml&#45;tag">&#60;param&#45;value&#62;</span>/WEB&#45;INF/applicationContext.xml<span class="xml&#45;tag">&#60;param&#45;value&#62;</span>
    <span class="xml&#45;tag">&#60;/context&#45;param&#62;</span>
<span class="xml&#45;tag">&#60;/web&#45;app&#62;</span></pre></div><p class="paragraph"/>The additional configuration part containing listener and context parameter definition is a usual Spring container related configuration detail. ContextLoaderListener is an implementation of standard Servlet API ServletContextListener interface provided by the Spring framework itself and is responsible for looking up an according bean definition file(s) specified by the context param above and creating an ApplicationContext instance during servlet context initialization accordingly. When integrating an ApplicationContext instance with Wicket, one of the beans defined in the above mentioned Spring bean definition file has to be your own specific extension of <code>org.apache.wicket.protocol.http.WebApplication</code>. You can either define a suitable bean in the bean definition file itself:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;beans&#62;</span>
    <span class="xml&#45;tag">&#60;bean id=<span class="xml&#45;quote">"myWebApp"</span> class=<span class="xml&#45;quote">"com.comsysto.webapp.MyWebApplication"</span>/&#62;</span>
<span class="xml&#45;tag">&#60;/beans&#62;</span></pre></div><p class="paragraph"/>or use powerful classpath scanning feature of the Spring framework and annotate the MyWebApplication implementation with the appropriate <code>&#64;Component</code> annotation accordingly while enabling the Spring container to scan the according package(s) of your application for relevant bean definitions:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;beans&#62;</span>
    <span class="xml&#45;tag">&#60;context:component&#45;scan base&#45;package=<span class="xml&#45;quote">"com.comsysto.webapp"</span> /&#62;</span>
    <span class="xml&#45;tag">&#60;context:component&#45;scan base&#45;package=<span class="xml&#45;quote">"com.comsysto.webapp.service"</span> /&#62;</span>
    <span class="xml&#45;tag">&#60;context:component&#45;scan base&#45;package=<span class="xml&#45;quote">"com.comsysto.webapp.repository"</span> /&#62;</span>
<span class="xml&#45;tag">&#60;/beans&#62;</span></pre></div><p class="paragraph"/>Either way, if everything goes well, you'll get a pre-configured ApplicationContext all set up during the startup of your web container. One of the beans in the ApplicationContext will be your own extension of Wicket's WebApplication type. SpringWebApplicationFactory implementation provided by the Wicket framework itself that you have defined as the <code>applicationFactoryClassName</code> in the configuration of your WicketFilter will then be used in order to retrieve that very same WebApplication bean out of your Spring ApplicationContext. The Factory expects one and only one extension of Wicket's very own WebApplication type to be found within the ApplicationContext instance at runtime. If no such bean or more than one bean extending WebApplication is found in the given ApplicationContext an according IllegalStateException will be raised and initialization of your web application will fail:<p class="paragraph"/><div class="code"><pre>Map&#60;?,?&#62; beans = BeanFactoryUtils.beansOfTypeIncludingAncestors(ac,WebApplication.class, <span class="java&#45;keyword">false</span>, <span class="java&#45;keyword">false</span>);
<span class="java&#45;keyword">if</span> (beans.size() == 0)
&#123;
	<span class="java&#45;keyword">throw</span> <span class="java&#45;keyword">new</span> IllegalStateException(<span class="java&#45;quote">"bean of type &#91;"</span> + WebApplication.class.getName() +
			<span class="java&#45;quote">"&#93; not found"</span>);
&#125;
<span class="java&#45;keyword">if</span> (beans.size() &#62; 1)
&#123;
	<span class="java&#45;keyword">throw</span> <span class="java&#45;keyword">new</span> IllegalStateException(<span class="java&#45;quote">"more than one bean of type &#91;"</span> +
			WebApplication.class.getName() + <span class="java&#45;quote">"&#93; found, must have only one"</span>);
&#125;</pre></div><p class="paragraph"/>After the WebApplication bean has been successfully retrieved from the ApplicationContext via SpringWebApplicationFactory, WicketFilter will then, as part of its own initialization process, trigger both internalInit() and init() methods of the WebApplication bean. The latter one is the exact spot where the last piece of the runtime configuration puzzle between Wicket and Spring is to be placed :<p class="paragraph"/><div class="code"><pre>@Component
<span class="java&#45;keyword">public</span> class MyWebApplication <span class="java&#45;keyword">extends</span> WebApplication &#123;
    @Override
    <span class="java&#45;keyword">protected</span> void init() &#123;
        addComponentInstantiationListener(<span class="java&#45;keyword">new</span> SpringComponentInjector(<span class="java&#45;keyword">this</span>));
    &#125;<p class="paragraph"/>&#125;</pre></div><p class="paragraph"/>SpringComponentInjector provided by the Wicket framework enables you to get dependencies from the ApplicationContext directly injected into your Wicket components by simply annotating these with the according <code>&#64;SpringBean</code> annotation.


                <div style="clear:both;margin-top:15px;"></div>
                
                    <div class="toc-item prev-left"><a href="../../guide/testing.html">&lt;&lt; <strong>22</strong><span>Test Driven Development with Wicket</span></a></div>
                
                    <div class="toc-item next-right"><a href="../../guide/bestpractices.html"><strong>24</strong><span>Wicket Best Practices</span> >></a></div>
                
                <div style="clear:both"></div>
            </div>
        </td>
        <td id="col2">
            <div class="local clearfix">
                <div class="local-title">
                    <a href="../../guide/index.html" target="mainFrame">Quick Reference</a>
                    <span class="toggle">(<a href="#" onclick="localToggle(); return false;">hide</a>)</span>
                </div>
                <div class="menu">
                    
                </div>
            </div>
        </td>
    </tr>
</table>

<div id="footer">
    
Copyright &copy; 2013-2014 — <a href="http://www.apache.org/" target="_blank">The Apache Software Foundation</a> 
                      — <b style="color:#E8590A !important;">(Generated on: 2015-02-12)</b>

    
</div>

<script type="text/javascript" src="../js/docs.js"></script>

</body>
</html>
