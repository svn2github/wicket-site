<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <title>18.2 Build-in AJAX components 6.x</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8"/>
    <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8"/>
    <script type="text/javascript">
function addJsClass() {
    var classes = document.body.className.split(" ");
    classes.push("js");
    document.body.className = classes.join(" ");
}
    </script>
</head>

<body class="body" onload="addJsClass();">
<div id="navigation">
    <ul>
        <li>
            <div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)">
                <a href="../../guide/index.html" class="button">Table of contents</a>

                <div id="nav-summary-childs" style="display:none;">
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter1.html"><strong>1</strong><span>Introduction</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/howToSource.html"><strong>2</strong><span>How to use the example code</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter2.html"><strong>3</strong><span>Why should I learn Wicket?</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter3.html"><strong>4</strong><span>Wicket says &ldquo;Hello world!&rdquo;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter4.html"><strong>5</strong><span>Wicket as page layout manager</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter5.html"><strong>6</strong><span>Keeping control over HTML</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter6.html"><strong>7</strong><span>Components lifecycle</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter7.html"><strong>8</strong><span>Page versioning and caching</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter8.html"><strong>9</strong><span>Under the hood of the request processing</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter9.html"><strong>10</strong><span>Wicket Links and URL generation</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter10.html"><strong>11</strong><span>Wicket models and forms</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter11.html"><strong>12</strong><span>Wicket forms in detail</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter12.html"><strong>13</strong><span>Displaying multiple items with repeaters</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter13.html"><strong>14</strong><span>Internationalization with Wicket</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter14.html"><strong>15</strong><span>Resource management with Wicket</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter15.html"><strong>16</strong><span>An example of integration with JavaScript</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter16.html"><strong>17</strong><span>Wicket advanced topics</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter17.html"><strong>18</strong><span>Working with AJAX</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter18.html"><strong>19</strong><span>Integration with enterprise containers</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter19.html"><strong>20</strong><span>Security with Wicket</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter20.html"><strong>21</strong><span>Test Driven Development with Wicket</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter21.html"><strong>22</strong><span>Test Driven Development with Wicket and Spring</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter22.html"><strong>23</strong><span>Wicket Best Practices</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter23.html"><strong>24</strong><span>Working with Maven (Appendix)</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter24.html"><strong>25</strong><span>Project WicketStuff (Appendix)</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter25.html"><strong>26</strong><span>Lost In Redirection With Apache Wicket (Appendix)</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/chapter26.html"><strong>27</strong><span>Contributing to this guide (Appendix)</span></a>
                    </div>
                    
                </div>
            </div>
        </li>
        <li class="separator selected">
            <a id="ref-button" onclick="localToggle(); return false;" href="#">Quick Reference</a>
        </li>
    </ul>
</div>
<div id="header">
    <div class="images clearfix">
        
        <span id="logo"><a href="/" target="_blank"><img height="80px" src="http://wicket.apache.org/guide/img/apache-wicket.png"/></a></span>
        
        
        <span id="sponsor"><a href="http://www.apache.org/" target="_blank"><img height="60px" src="../img/asf_logo.gif"/></a></span>
        
    </div>
    <p>Free Online Guide for Apache Wicket framework</p>
</div>


<table id="colset" border="0" cellpadding="0" cellspacing="0">
    <tr>
        <td id="col1">
            <div id="main" class="corner-all">

                
                    <div class="toc-item prev-left"><a href="../../guide/chapter16.html">&lt;&lt; <strong>17</strong><span>Wicket advanced topics</span></a></div>
                

                <span id='toggle-col1' class="toggle">(<a href="#" onclick="localToggle(); return false;">Quick Reference</a>)</span>

                
                    <div class="toc-item next-right"><a href="../../guide/chapter18.html"><strong>19</strong><span>Integration with enterprise containers</span> >></a></div>
                


                <div class="project">
                    <h1>18.2 Build-in AJAX components - Reference Documentation</h1>

                    <p><strong>Authors:</strong> Andrea Del Bene, Carsten Hufe, Christian Kroemer, Daniel Bartl, Paul Borș</p>

                    <p><strong>Version:</strong> 6.x</p>

                    
                </div>

                

                

<h2 id="chapter17_2">18.2 Build-in AJAX components</h2>
<p class="paragraph"/>Wicket distribution comes with a number of built-in AJAX components ready to be used. Some of them are the ajaxified version of common components like links and buttons, while others are AJAX-specific components.<p class="paragraph"/>AJAX components are not different from any other component seen so far and they don't require any additional configuration to be used. As we will shortly see, switching from a classic link or button to the ajaxified version is just a matter of appending “Ajax” to the component class name.<p class="paragraph"/>This paragraph provides an overview of what we can find in Wicket to start writing AJAX-enhanced web applications.<p class="paragraph"/><h3>Links and buttons</h3><p class="paragraph"/>In the previous paragraph we have already introduced component AjaxLink. Wicket provides also the ajaxified versions of submitting components SubmitLink and Button which are simply called AjaxSubmitLink and AjaxButton. These components come with a version of methods onSubmit, onError and onAfterSubmit that takes in input also an instance of AjaxRequestTarget.<p class="paragraph"/>Both components are in package org.apache.wicket.ajax.markup.html.form.<p class="paragraph"/><h3>Fallback components</h3><p class="paragraph"/>Building an entire site using AJAX can be risky as some clients may not support this technology. In order to provide an usable version of our site also to these clients, we can use components AjaxFallbackLink and AjaxFallbackButton which are able to automatically degrade to a standard link or to a standard button if client doesn't support AJAX.<p class="paragraph"/><h3>AJAX Checkbox</h3><p class="paragraph"/>Class org.apache.wicket.ajax.markup.html.form.AjaxCheckBox is a checkbox component that updates its model via AJAX when user changes its value. Its AJAX callback method is onUpdate(AjaxRequestTarget target). The component extends standard checkbox component CheckBox adding an AjaxFormComponentUpdatingBehavior to itself (we will see this behavior later in paragraph 16.3.3).<p class="paragraph"/><h3>AJAX editable labels</h3><p class="paragraph"/>An editable label is a special label that can be edited by the user when she/he clicks on it. Wicket ships three different implementations for this component (all inside package org.apache.wicket. extensions.ajax.markup.html):
<ul class="star">
<li><strong class="bold">AjaxEditableLabel</strong>: it's a basic version of editable label. User can edit the content of the label with a text field. This is also the base class for the other two editable labels.</li>
<li><strong class="bold">AjaxEditableMultiLineLabel</strong>: this label supports multi-line values and uses a text area as editor component.</li>
<li><strong class="bold">AjaxEditableChoiceLabel</strong>: this label uses a drop-down menu to edit its value.</li>
</ul><p class="paragraph"/>Base component AjaxEditableLabel exposes the following set of AJAX-aware methods that can be overriden:
<ul class="star">
<li><strong class="bold">onEdit(AjaxRequestTarget target)</strong>: called when user clicks on component. The default implementation shows the component used to edit the value of the label.</li>
<li><strong class="bold">onSubmit(AjaxRequestTarget target)</strong>: called when the value has been successfully updated with the new input.</li>
<li><strong class="bold">onError(AjaxRequestTarget target)</strong>: called when the new inserted input has failed validation.</li>
<li><strong class="bold">onCancel(AjaxRequestTarget target)</strong>: called when user has exited from editing mode pressing escape key. The default implementation brings back the label to its initial state hiding the editor component.</li>
</ul><p class="paragraph"/>Wicket module wicket-examples contains page class EditableLabelPage.java which shows all these three components together. You can see this page in action at <a href="http://www.wicket-library.com/wicket-examples-6.0.x/ajax/editable-label" target="blank">http://www.wicket-library.com/wicket-examples-6.0.x/ajax/editable-label</a> :<p class="paragraph"/><img border="0" class="center" src="../img/edit-label-example-screenshot.png"></img><p class="paragraph"/><h3>Autocomplete text field</h3><p class="paragraph"/>On Internet we can find many examples of text fields that display a list of suggestions (or options) while the user types a text inside them. This feature is known as autocomplete functionality.<p class="paragraph"/>Wicket offers an out-of-the-box implementation of an autocomplete text field with component org.apache.wicket.extensions.ajax.markup.html.autocomplete.AutoCompleteTextField.<p class="paragraph"/>When using AutoCompleteTextField we are required to implement its abstract method getChoices(String input) where the input parameter is the current input of the component. This method returns an iterator over the suggestions that will be displayed as a drop-down menu:<p class="paragraph"/><img border="0" class="center" src="../img/autocomplete-example-screenshot.png"></img><p class="paragraph"/>Suggestions are rendered using a render which implements interface IAutoCompleteRenderer. The default implementation simply calls toString() on each suggestion object. If we need to work with a custom render we can specify it via component constructor.<p class="paragraph"/>AutoCompleteTextField supports a wide range of settings that are passed to its constructor with class AutoCompleteSettings.<p class="paragraph"/>One of the most interesting parameter we can specify for AutoCompleteTextField is the throttle delay which is the amount of time (in milliseconds) that must elapse between a change of input value and the transmission of a new Ajax request to display suggestions. This parameter can be set with method setThrottleDelay(int):<p class="paragraph"/><div class="code"><pre>AutoCompleteSettings settings = <span class="java&#45;keyword">new</span> AutoCompleteSettings();
//set throttle to 400 ms: component will wait 400ms before displaying the options		
settings.setThrottleDelay(400);
//...		
AutoCompleteTextField field = <span class="java&#45;keyword">new</span> AutoCompleteTextField&#60;T&#62;(<span class="java&#45;quote">"field"</span>, model) &#123;<p class="paragraph"/>	@Override
	<span class="java&#45;keyword">protected</span> Iterator getChoices(<span class="java&#45;object">String</span> arg0) &#123;
		//<span class="java&#45;keyword">return</span> an iterator over the options 
	&#125;
&#125;;</pre></div><p class="paragraph"/>Wicket module wicket-examples contains page class AutoCompletePagePage.java which shows an example of autocomplete text field. The running example is available at <a href="http://www.wicket-library.com/wicket-examples-6.0.x/ajax/autocomplete" target="blank">http://www.wicket-library.com/wicket-examples-6.0.x/ajax/autocomplete</a> .<p class="paragraph"/><h3>Modal window</h3><p class="paragraph"/>Class org.apache.wicket.extensions.ajax.markup.html.modal.ModalWindow is an implementation of a <a href="http://en.wikipedia.org/wiki/Modal_window" target="blank">modal window</a> based on AJAX:<p class="paragraph"/><img border="0" class="center" src="../img/modal-window-example-screenshot.png"></img><p class="paragraph"/>The content of a modal window can be either another component or a page. In the first case the id of the  component used as content must be retrieved with method getContentId().<p class="paragraph"/>If instead we want to use a page as window content, we must implement the inner interface ModalWindow.PageCreator and pass it to method setPageCreator. The page used as content will be embedded in a &#60;iframe&#62; tag.<p class="paragraph"/>To display a modal window we must call its method show(AjaxRequestTarget target). This is  usually done inside the AJAX callback method of another component (like an AjaxLink). The following markup and code are taken from project BasicModalWindowExample and illustrate a basic usage of a modal window:<p class="paragraph"/><strong class="bold">HTML:</strong>
<div class="code"><pre>&#60;body&#62;
	&#60;h2&#62;Modal Windod example&#60;/h2&#62;
	&#60;a wicket:id=<span class="java&#45;quote">"openWindow"</span>&#62;Open the window!&#60;/a&#62;
	&#60;div wicket:id=<span class="java&#45;quote">"modalWindow"</span>&#62;&#60;/div&#62;
&#60;/body&#62;</pre></div><p class="paragraph"/><strong class="bold">Java Code:</strong>
<div class="code"><pre><span class="java&#45;keyword">public</span> HomePage(<span class="java&#45;keyword">final</span> PageParameters parameters) &#123;
   	<span class="java&#45;keyword">super</span>(parameters);
   	<span class="java&#45;keyword">final</span> ModalWindow modalWindow = <span class="java&#45;keyword">new</span> ModalWindow(<span class="java&#45;quote">"modalWindow"</span>);
   	Label label = <span class="java&#45;keyword">new</span> Label(modalWindow.getContentId(), <span class="java&#45;quote">"I'm a modal window!"</span>);<p class="paragraph"/>   	modalWindow.setContent(label);
   	modalWindow.setTitle(<span class="java&#45;quote">"Modal window"</span>);<p class="paragraph"/>   	add(modalWindow);
   	add(<span class="java&#45;keyword">new</span> AjaxLink(<span class="java&#45;quote">"openWindow"</span>) &#123;
	  @Override
	  <span class="java&#45;keyword">public</span> void onClick(AjaxRequestTarget target) &#123;
		modalWindow.show(target);				
	  &#125;    		
	&#125;);
&#125;</pre></div><p class="paragraph"/>Just like any other component also ModalWindow must be added to a markup tag, like we did in our example using a &#60;div&#62; tag. Wicket will automatically hide this tag in the final markup appending the style value display:none. 
The component provides different setter methods to customize the appearance of the window:
<ul class="star">
<li><strong class="bold">setTitle(String)</strong>: specifies the title of the window</li>
<li><strong class="bold">setResizable(boolean)</strong>: by default the window is resizeable. If we need to make its size fixed we can use this method to turn off this feature.</li>
<li><strong class="bold">setInitialWidth(int) and setInitialHeight(int)</strong>: set the initial dimensions of the window.</li>
<li><strong class="bold">setMinimalWidth(int) and setMinimalHeight(int)</strong>: specify the minimal dimensions of the window.</li>
<li><strong class="bold">setCookieName(String)</strong>: this method can be used to specify the name of the cookie used on  client side to store size and position of the window when it is closed. The component will use this cookie to restore these two parameters the next time the window will be opened. If no cookie name is provided, the component will not remember its last position and size.</li>
<li><strong class="bold">setCssClassName(String)</strong>: specifies the CSS class used for the window.</li>
<li><strong class="bold">setAutoSize(boolean)</strong>: when this flag is set to true the window will automatically adjust its size to fit content width and height. By default it is false.</li>
</ul><p class="paragraph"/>The modal window can be closed from code using its method close(AjaxRequestTarget target). The currently opened window can be closed also with the following JavaScript instruction:<p class="paragraph"/><div class="code"><pre>Wicket.Window.get().close();</pre></div><p class="paragraph"/>ModalWindow gives the opportunity to perform custom actions when window is closing. Inner interface ModalWindow.WindowClosedCallback can be implemented and passed to window's method setWindowClosedCallback to specify the callback that must be executed after window has been closed:<p class="paragraph"/><div class="code"><pre>modalWindow.setWindowClosedCallback(<span class="java&#45;keyword">new</span> ModalWindow.WindowClosedCallback() &#123;<p class="paragraph"/>	@Override
	<span class="java&#45;keyword">public</span> void onClose(AjaxRequestTarget target) &#123;
	  //custom code&#8230;
	&#125;			
&#125;);</pre></div><p class="paragraph"/><h3>Tree repeaters</h3><p class="paragraph"/>Class org.apache.wicket.extensions.markup.html.repeater.tree.AbstractTree is the base class of another family of repeaters called tree repeaters and designed to display a data hierarchy as a tree, resembling the behavior and the look &#38; feel of desktop tree components. A classic example of tree component on desktop is the tree used by nearly all file managers to navigate file system:<p class="paragraph"/><img border="0" class="center" src="../img/file-system-trees.png"></img><p class="paragraph"/>Because of their highly interactive nature, tree repeaters are implemented as AJAX components,  meaning that they are updated via AJAX when we expand or collapse their nodes.<p class="paragraph"/>The basic implementation of a tree repeater shipped with Wicket is component NestedTree. In order to use a tree repeater we must provide an implementation of interface ITreeProvider which is in charge of returning the nodes that compose the tree.<p class="paragraph"/>Wicket comes with a built-in implementation of ITreeProvider called TreeModelProvider that works with the same tree model and nodes used by Swing component javax.swing.JTree. These Swing entities should be familiar to you if you have previously worked with the old tree repeaters (components Tree and TreeTable) that have been deprecated with Wicket 6 and that are strongly dependent on Swing-based model and nodes. TreeModelProvider can be used to migrate your code to the new tree repeaters.<p class="paragraph"/>In the next example (project CheckBoxAjaxTree) we will build a tree that displays some of the main cities of three European countries: Italy, Germany and France. The cities are sub-nodes of a main node representing the relative county. The nodes of the final tree will be also selectable with a checkbox control. The whole tree will have the classic look &#38; feel of Windows XP. This is how our tree will look like:<p class="paragraph"/><img border="0" class="center" src="../img/AJAX-tree-repeater.png"></img><p class="paragraph"/>We will start to explore the code of this example from the home page. The first portion of code we will see is where we build the nodes and the TreeModelProvider for the three. As tree node we will use Swing class javax.swing.tree.DefaultMutableTreeNode:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">public</span> class HomePage <span class="java&#45;keyword">extends</span> WebPage &#123;
    <span class="java&#45;keyword">public</span> HomePage(<span class="java&#45;keyword">final</span> PageParameters parameters) &#123;
     <span class="java&#45;keyword">super</span>(parameters);
     DefaultMutableTreeNode root = <span class="java&#45;keyword">new</span> DefaultMutableTreeNode(<span class="java&#45;quote">"Cities of Europe"</span>);<p class="paragraph"/>     addNodes(addNodes(root, <span class="java&#45;quote">"Italy"</span>), <span class="java&#45;quote">"Rome"</span>, <span class="java&#45;quote">"Venice"</span>, <span class="java&#45;quote">"Milan"</span>, <span class="java&#45;quote">"Florence"</span>);
     addNodes(addNodes(root, <span class="java&#45;quote">"Germany"</span>),<span class="java&#45;quote">"Stuttgart"</span>,<span class="java&#45;quote">"Munich"</span>, <span class="java&#45;quote">"Berlin"</span>,<span class="java&#45;quote">"Dusseldorf"</span>, <span class="java&#45;quote">"Dresden"</span>);
     addNodes(addNodes(root, <span class="java&#45;quote">"France"</span>), <span class="java&#45;quote">"Paris"</span>,<span class="java&#45;quote">"Toulouse"</span>, <span class="java&#45;quote">"Strasbourg"</span>,<span class="java&#45;quote">"Bordeaux"</span>, <span class="java&#45;quote">"Lyon"</span>);<p class="paragraph"/>     DefaultTreeModel treeModel = <span class="java&#45;keyword">new</span> DefaultTreeModel(root);
     TreeModelProvider&#60;DefaultMutableTreeNode&#62; modelProvider = <span class="java&#45;keyword">new</span> 
                            TreeModelProvider&#60;DefaultMutableTreeNode&#62;( treeModel )&#123;
       @Override
       <span class="java&#45;keyword">public</span> IModel&#60;DefaultMutableTreeNode&#62; model(DefaultMutableTreeNode object)&#123;
          <span class="java&#45;keyword">return</span> Model.of(object);
       &#125;
     &#125;;
     //To be continued...</pre></div><p class="paragraph"/>Nodes have been built using simple strings as data objects and invoking custom utility method addNodes which converts string parameters into children nodes for a given parent node. Once we have our tree of DefaultMutableTreeNodes we can build the Swing tree model (DefaultTreeModel) that will be the backing object for a TreeModelProvider. This provider wraps each node in a model invoking its abstract method model. In our example we have used a simple Model as wrapper model.<p class="paragraph"/>Scrolling down the code we can see how the tree component is instantiated and configured before being added to the home page:<p class="paragraph"/><div class="code"><pre>//Continued from previous snippet&#8230;
 NestedTree&#60;DefaultMutableTreeNode&#62; tree = <span class="java&#45;keyword">new</span> NestedTree&#60;DefaultMutableTreeNode&#62;(<span class="java&#45;quote">"tree"</span>, 
                                                      modelProvider)
  &#123;<p class="paragraph"/>   @Override
   <span class="java&#45;keyword">protected</span> Component newContentComponent(<span class="java&#45;object">String</span> id, IModel&#60;DefaultMutableTreeNode&#62;model)
   &#123;
     <span class="java&#45;keyword">return</span> <span class="java&#45;keyword">new</span> CheckedFolder&#60;DefaultMutableTreeNode&#62;(id, <span class="java&#45;keyword">this</span>, model);
   &#125;
  &#125;;
  //select Windows theme
  tree.add(<span class="java&#45;keyword">new</span> WindowsTheme());<p class="paragraph"/>  add(tree);
  &#125;
  //implementation of addNodes
  //&#8230;
&#125;</pre></div><p class="paragraph"/>To use tree repeaters we must implement their abstract method newContentComponent which is called internally by base class AbstractTree when a new node must be built. As content component we have used built-in class CheckedFolder which combines a Folder component with a CheckBox form control.<p class="paragraph"/>The final step before adding the tree to its page is to apply a theme to it. Wicket comes with two behaviors, WindowsTheme and HumanTheme, which correspond to the classic Windows XP theme and to the Human theme from Ubuntu.<p class="paragraph"/>Our checkable tree is finished but our work is not over yet because the component doesn't offer many functionalities as it is. Unfortunately neither NestedTree nor CheckedFolder provide a means for collecting checked nodes and returning them to client code. It's up to us to implement a way to keep track of checked nodes.<p class="paragraph"/>Another nice feature we would like to implement for our tree is the following user-friendly behavior that should occur when a user checks/unchecks a node:
<ul class="star">
<li>When a node is checked also all its children nodes (if any) must be checked. We must also ensure that all the ancestors of the checked node (root included) are checked, otherwise we would get an inconsistent selection.</li>
<li>When a node is unchecked also all its children nodes (if any) must be unchecked and we must also ensure that ancestors get unchecked if they have no more checked children.</li>
</ul><p class="paragraph"/>The first goal (keeping track of checked node) can be accomplished building a custom version of CheckedFolder that uses a shared Java Set to store checked node and to verify if its node has been  checked. This kind of solution requires a custom model for checkbox component in order to reflect its checked status when its container node is rendered. This model must implement typed interface IModel&#60;Boolean&#62; and must be returned by CheckedFolder's method newCheckBoxModel.<p class="paragraph"/>For the second goal (auto select/unselect children and ancestor nodes) we can use CheckedFolder's callback method onUpdate(AjaxRequestTarget) that is invoked after a checkbox is clicked and its value has been updated. Overriding this method we can handle user click adding/removing nodes to/from the Java Set.<p class="paragraph"/>Following this implementation plan we can start coding our custom CheckedFolder (named AutocheckedFolder):<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">public</span> class AutocheckedFolder&#60;T&#62; <span class="java&#45;keyword">extends</span> CheckedFolder&#60;T&#62; &#123;<p class="paragraph"/>   <span class="java&#45;keyword">private</span> ITreeProvider&#60;T&#62; treeProvider;
   <span class="java&#45;keyword">private</span> IModel&#60;Set&#60;T&#62;&#62; checkedNodes;
   <span class="java&#45;keyword">private</span> IModel&#60;<span class="java&#45;object">Boolean</span>&#62; checkboxModel;<p class="paragraph"/>   <span class="java&#45;keyword">public</span> AutocheckedFolder(<span class="java&#45;object">String</span> id, AbstractTree&#60;T&#62; tree, 
                        IModel&#60;T&#62; model, IModel&#60;Set&#60;T&#62;&#62; checkedNodes) &#123;
      <span class="java&#45;keyword">super</span>(id, tree, model);   
      <span class="java&#45;keyword">this</span>.treeProvider = tree.getProvider();
      <span class="java&#45;keyword">this</span>.checkedNodes = checkedNodes;            
   &#125;<p class="paragraph"/>   @Override
   <span class="java&#45;keyword">protected</span> IModel&#60;<span class="java&#45;object">Boolean</span>&#62; newCheckBoxModel(IModel&#60;T&#62; model) &#123;
      checkboxModel =  <span class="java&#45;keyword">new</span> CheckModel();
      <span class="java&#45;keyword">return</span> checkboxModel;
   &#125;<p class="paragraph"/>   @Override
   <span class="java&#45;keyword">protected</span> void onUpdate(AjaxRequestTarget target) &#123;
      <span class="java&#45;keyword">super</span>.onUpdate(target);
      T node = getModelObject();
      <span class="java&#45;object">boolean</span> nodeChecked = checkboxModel.getObject();<p class="paragraph"/>      addRemoveSubNodes(node, nodeChecked);            
      addRemoveAncestorNodes(node, nodeChecked);            
   &#125;<p class="paragraph"/>  class CheckModel <span class="java&#45;keyword">extends</span> AbstractCheckBoxModel&#123;
      @Override
      <span class="java&#45;keyword">public</span> <span class="java&#45;object">boolean</span> isSelected() &#123;
         <span class="java&#45;keyword">return</span> checkedNodes.getObject().contains(getModelObject());
      &#125;<p class="paragraph"/>      @Override
      <span class="java&#45;keyword">public</span> void select() &#123;
         checkedNodes.getObject().add(getModelObject());
      &#125;<p class="paragraph"/>      @Override
      <span class="java&#45;keyword">public</span> void unselect() &#123;
         checkedNodes.getObject().remove(getModelObject());
      &#125;				
  &#125;
&#125;</pre></div><p class="paragraph"/>The constructor of this new component takes in input a further parameter which is the set containing checked nodes.<p class="paragraph"/>Class CheckModel is the custom model we have implemented for checkbox control. As base class for this model we have used AbstractCheckBoxModel which is provided to implement custom models for checkbox controls.<p class="paragraph"/>Methods addRemoveSubNodes and addRemoveAncestorNodes are called to automatically add/remove children and ancestor nodes to/from the current Set. Their implementation is mainly focused on the navigation of tree nodes and it heavily depends on the internal implementation of the tree, so we won't dwell on their code.<p class="paragraph"/>Now we are just one step away from completing our tree as we still have to find a way to update the checked status of both children and ancestors nodes on client side. Although we could easily accomplish this task by simply refreshing the whole tree via AJAX, we would like to find a better and more performant solution for this task.<p class="paragraph"/>When we modify the checked status of a node we don't expand/collapse any node of the three so we can simply update the desired checkboxes rather than updating the entire tree component. This alternative approach could lead to a more responsive interface and to a strong reduction of bandwidth consumption.<p class="paragraph"/>With the help of JQuery we can code a couple of JavaScript functions that can be used to check/ uncheck all the children and ancestors of a given node. Then, we can append these functions to the current AjaxRequest at the end of method onUpdate:<p class="paragraph"/><div class="code"><pre>@Override
   <span class="java&#45;keyword">protected</span> void onUpdate(AjaxRequestTarget target) &#123;
      <span class="java&#45;keyword">super</span>.onUpdate(target);
      T node = getModelObject();
      <span class="java&#45;object">boolean</span> nodeChecked = checkboxModel.getObject();<p class="paragraph"/>      addRemoveSubNodes(node, nodeChecked);            
      addRemoveAncestorNodes(node, nodeChecked);    
      updateNodeOnClientSide(target, nodeChecked);		
   &#125;<p class="paragraph"/>   <span class="java&#45;keyword">protected</span> void updateNodeOnClientSide(AjaxRequestTarget target,
			<span class="java&#45;object">boolean</span> nodeChecked) &#123;
      target.appendJavaScript(<span class="java&#45;quote">";CheckAncestorsAndChildren.checkChildren('"</span> + getMarkupId() + 
                              <span class="java&#45;quote">"',"</span> + nodeChecked + <span class="java&#45;quote">");"</span>);<p class="paragraph"/>      target.appendJavaScript(<span class="java&#45;quote">";CheckAncestorsAndChildren.checkAncestors('"</span> + getMarkupId() + 
                              <span class="java&#45;quote">"',"</span> + nodeChecked + <span class="java&#45;quote">");"</span>);
   &#125;</pre></div><p class="paragraph"/>The JavaScript code can be found inside file autocheckedFolder.js which is added to the header section as package resource:<p class="paragraph"/><div class="code"><pre>@Override
<span class="java&#45;keyword">public</span> void renderHead(IHeaderResponse response) &#123;
	PackageResourceReference scriptFile = <span class="java&#45;keyword">new</span> PackageResourceReference(<span class="java&#45;keyword">this</span>.getClass(), 
                                                      <span class="java&#45;quote">"autocheckedFolder.js"</span>);
	response.render(JavaScriptHeaderItem.forReference(scriptFile));
&#125;</pre></div><p class="paragraph"/><h3>Working with hidden components</h3><p class="paragraph"/>When a component is not visible its markup and the related id attribute are not rendered in the final page, hence it can not be updated via AJAX. To overcome this problem we must use Component's method setOutputMarkupPlaceholderTag(true) which has the effect of rendering a hidden &#60;span&#62; tag containing the markup id of the hidden component:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">final</span> Label label = <span class="java&#45;keyword">new</span> Label(<span class="java&#45;quote">"labelComponent"</span>, <span class="java&#45;quote">"Initial value."</span>);
//make label invisible
label.setVisible(<span class="java&#45;keyword">false</span>);
//ensure that label will leave a placeholder <span class="java&#45;keyword">for</span> its markup id
label.setOutputMarkupPlaceholderTag(<span class="java&#45;keyword">true</span>);
add(label);
//&#8230;
<span class="java&#45;keyword">new</span> AjaxLink(<span class="java&#45;quote">"ajaxLink"</span>)&#123;
	@Override
	<span class="java&#45;keyword">public</span> void onClick(AjaxRequestTarget target) &#123;
	    //turn label to visible
	    label.setVisible(<span class="java&#45;keyword">true</span>);
	    target.add(label);
	&#125;  	
&#125;;</pre></div><p class="paragraph"/>Please note that in the code above we didn't invoked method setOutputMarkupId(true) as setOutputMarkupPlaceholderTag already does it internally.



                <div style="clear:both;margin-top:15px;"></div>
                
                    <div class="toc-item prev-left"><a href="../../guide/chapter16.html">&lt;&lt; <strong>17</strong><span>Wicket advanced topics</span></a></div>
                
                    <div class="toc-item next-right"><a href="../../guide/chapter18.html"><strong>19</strong><span>Integration with enterprise containers</span> >></a></div>
                
                <div style="clear:both"></div>
            </div>
        </td>
        <td id="col2">
            <div class="local clearfix">
                <div class="local-title">
                    <a href="../../guide/index.html" target="mainFrame">Quick Reference</a>
                    <span class="toggle">(<a href="#" onclick="localToggle(); return false;">hide</a>)</span>
                </div>
                <div class="menu">
                    
                </div>
            </div>
        </td>
    </tr>
</table>

<div id="footer">
    
Copyright &copy; 2013 — <a href="http://www.apache.org/" target="_blank">The Apache Software Foundation</a>

    
</div>

<script type="text/javascript" src="../js/docs.js"></script>

</body>
</html>
