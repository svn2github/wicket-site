<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <title>12 Wicket forms in detail 6.x</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8"/>
    <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8"/>
    <script type="text/javascript">
function addJsClass() {
    var classes = document.body.className.split(" ");
    classes.push("js");
    document.body.className = classes.join(" ");
}
    </script>
</head>

<body class="body" onload="addJsClass();">
<div id="navigation">
    <ul>
        <li>
            <div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)">
                <a href="../guide/index.html" class="button">Table of contents</a>

                <div id="nav-summary-childs" style="display:none;">
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/introduction.html"><strong>1</strong><span>Introduction</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/howToSource.html"><strong>2</strong><span>How to use the example code</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/whyLearn.html"><strong>3</strong><span>Why should I learn Wicket?</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/helloWorld.html"><strong>4</strong><span>Wicket says &ldquo;Hello world!&rdquo;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/layout.html"><strong>5</strong><span>Wicket as page layout manager</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/keepControl.html"><strong>6</strong><span>Keeping control over HTML</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/componentLifecycle.html"><strong>7</strong><span>Components lifecycle</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/versioningCaching.html"><strong>8</strong><span>Page versioning and caching</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/requestProcessing.html"><strong>9</strong><span>Under the hood of the request processing</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/urls.html"><strong>10</strong><span>Wicket Links and URL generation</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/modelsforms.html"><strong>11</strong><span>Wicket models and forms</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/forms2.html"><strong>12</strong><span>Wicket forms in detail</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/repeaters.html"><strong>13</strong><span>Displaying multiple items with repeaters</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/i18n.html"><strong>14</strong><span>Internationalization with Wicket</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/resources.html"><strong>15</strong><span>Resource management with Wicket</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/jsintegration.html"><strong>16</strong><span>An example of integration with JavaScript</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/advanced.html"><strong>17</strong><span>Wicket advanced topics</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/ajax.html"><strong>18</strong><span>Working with AJAX</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/jee.html"><strong>19</strong><span>Integration with enterprise containers</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/nativewebsockets.html"><strong>20</strong><span>Native WebSockets</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/security.html"><strong>21</strong><span>Security with Wicket</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/testing.html"><strong>22</strong><span>Test Driven Development with Wicket</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/testingspring.html"><strong>23</strong><span>Test Driven Development with Wicket and Spring</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/bestpractices.html"><strong>24</strong><span>Wicket Best Practices</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/internals.html"><strong>25</strong><span>Wicket Internals</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/maven.html"><strong>26</strong><span>Working with Maven (Appendix)</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/wicketstuff.html"><strong>27</strong><span>Project WicketStuff (Appendix)</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/redirects.html"><strong>28</strong><span>Lost In Redirection With Apache Wicket (Appendix)</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/contributing.html"><strong>29</strong><span>Contributing to this guide (Appendix)</span></a>
                    </div>
                    
                </div>
            </div>
        </li>
        <li class="separator selected">
            <a id="ref-button" onclick="localToggle(); return false;" href="#">Quick Reference</a>
        </li>
    </ul>
</div>
<div id="header">
    <div class="images clearfix">
        
        <span id="logo"><a href="/" target="_blank"><img height="80px" src="http://wicket.apache.org/guide/img/apache-wicket.png"/></a></span>
        
        
        <span id="sponsor"><a href="http://www.apache.org/" target="_blank"><img height="60px" src="http://wicket.apache.org/guide/img/asf_logo.gif"/></a></span>
        
    </div>
    <p>Free Online Guide for Apache Wicket framework</p>
</div>


<table id="colset" border="0" cellpadding="0" cellspacing="0">
    <tr>
        <td id="col1">
            <div id="main" class="corner-all">

                
                    <div class="toc-item prev-left"><a href="../guide/modelsforms.html">&lt;&lt; <strong>11</strong><span>Wicket models and forms</span></a></div>
                

                <span id='toggle-col1' class="toggle">(<a href="#" onclick="localToggle(); return false;">Quick Reference</a>)</span>

                
                    <div class="toc-item next-right"><a href="../guide/repeaters.html"><strong>13</strong><span>Displaying multiple items with repeaters</span> >></a></div>
                


                <div class="project">
                    <h1>12 Wicket forms in detail - Reference Documentation</h1>

                    <p><strong>Authors:</strong> Andrea Del Bene, Martin Grigorov, Carsten Hufe, Christian Kroemer, Daniel Bartl, Paul Borș</p>

                    <p><strong>Version:</strong> 6.x</p>

                    
                </div>

                
                <div id="table-of-content">
                    <h2>Table of Contents</h2>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#forms2_1"><strong>12.1</strong><span>Default form processing</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#forms2_2"><strong>12.2</strong><span>Form validation and feedback messages</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#forms2_3"><strong>12.3</strong><span>Input value conversion</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#forms2_4"><strong>12.4</strong><span>Validation with JSR 303</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#forms2_5"><strong>12.5</strong><span>Submit form with an IFormSubmittingComponent</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#forms2_6"><strong>12.6</strong><span>Nested forms</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#forms2_7"><strong>12.7</strong><span>Multi-line text input</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#forms2_8"><strong>12.8</strong><span>File upload</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#forms2_9"><strong>12.9</strong><span>Creating complex form components with FormComponentPanel</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#forms2_10"><strong>12.10</strong><span>Stateless form</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#forms2_11"><strong>12.11</strong><span>Working with radio buttons and checkboxes</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#forms2_12"><strong>12.12</strong><span>Selecting multiple values with ListMultipleChoices and Palette</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#forms2_13"><strong>12.13</strong><span>Summary</span></a>
                    </div>
                    
                </div>
                

                

<h1 id="forms2">12 Wicket forms in detail</h1>
In the previous chapter we have only scratched the surface of Wicket forms. The Form component was not only designed to collect user input but also to extend the semantic of the classic HTML forms with new features.<p class="paragraph"/>One of such features is the ability to work with nested forms (they will be discussed in paragraph 10.5).<p class="paragraph"/>In this chapter we will continue to explore Wicket forms learning how to master them and how to build effective and user-proof forms for our web applications.


<h2 id="forms2_1">12.1 Default form processing</h2>
<p class="paragraph"/>In paragraph 9.3 we have seen a very basic usage of the Form component and we didn't pay much attention to what happens behind the scenes of form submission. In Wicket when we submit a form we trigger the following steps on server side:
<ol>
<li>Form validation: user input is checked to see if it satisfies the validation rules set on the form. If validation fails, step number 2 is skipped and the form should display a feedback message to explain to user what went wrong. During this step input values (which are simple strings sent with a web request) are converted into Java objects. In the next paragraphs we will explore the infrastructures provided by Wicket for the three sub-tasks involved with form validation, which are: conversion of user input into objects, validation of user input, and visualization of feedback messages.</li>
<li>Updating of models: if validation succeeds, the form updates the model of its children components with the converted values obtained in the previous step.</li>
<li>Invoking callback methods onSubmit() or onError(): if we didn't have any validation error, method onSubmit() is called, otherwise onError() will be called. The default implementation of both these methods is left empty and we can override them to perform custom actions.</li>
</ol><p class="paragraph"/><blockquote class="note">
Please note that the model of form components is updated only if no validation error occurred (i.e. step two is performed only if validation succeeds). 
</blockquote><p class="paragraph"/>Without going into too much detail, we can say that the first two steps of form processing correspond to the invocation of one or more Form's internal methods (which are declared protected and final). Some examples of these methods are validate(), which is invoked during validation step, and updateFormComponentModels(), which is used at the step that updates the form field models.<p class="paragraph"/>The whole form processing is started invoking public method process(IFormSubmitter) (Later in paragraph 10.4 we will introduce interface IFormSubmitter). 


<h2 id="forms2_2">12.2 Form validation and feedback messages</h2>
<p class="paragraph"/>A basic example of a validation rule is to make a field required. In paragraph 9.3.2 we have already seen how this can be done calling setRequired(true) on a field. However, to set a validation rule on a FormComponent we must add the corresponding validator to it.<p class="paragraph"/>A validator is an implementation of the <code>org.apache.wicket.validation.IValidator</code> interface and the <code>FormComponent</code> has a version of method add which takes as input a reference of this interface.<p class="paragraph"/>For example if we want to use a text field to insert an email address, we could use the built-in validator  EmailAddressValidator to ensure that the inserted input will respect the email format <a href="http://en.wikipedia.org/wiki/Email_address" target="blank">local-part@domain</a> :<p class="paragraph"/><div class="code"><pre>TextField email = <span class="java&#45;keyword">new</span> TextField(<span class="java&#45;quote">"email"</span>);
email.add(EmailAddressValidator.getInstance());</pre></div><p class="paragraph"/>Wicket comes with a set of built-in validators that should suit most of our needs. We will see them in paragraph 10.2.3.<p class="paragraph"/><h3>Feedback messages and localization</h3><p class="paragraph"/>Wicket generates a feedback message for each field that doesn't satisfy one of its validation rules. For example the message generated when a required field is left empty is the following<p class="paragraph"/><code>Field '&#60;label&#62;' is required.</code><p class="paragraph"/>&#60;label&#62; is the value of the label model set on a FormComponent with method setLabel(IModel &#60;String&#62; model). If such model is not provided, component id will be used as the default value.<p class="paragraph"/>The entire infrastructure of feedback messages is built on top of the Java internationalization (I18N) support and it uses <a href="http://docs.oracle.com/javase/tutorial/i18n/resbundle/index.html" target="blank">resource bundles</a> to store messages.<p class="paragraph"/><blockquote class="note">
The topics of internationalization will be covered in chapter 12. For now we will give just few notions needed to understand the examples from this chapter.
</blockquote><p class="paragraph"/>By default resource bundles are stored into properties files but we can easily configure other sources as described later in paragraph 12.4.5.<p class="paragraph"/>Default feedback messages (like the one above for required fields) are stored in the file Application. properties placed inside Wicket the org.apache.wicket package. Opening this file we can find the key and the localized value of the message:<p class="paragraph"/><code>Required=Field '$&#123;label&#125;' is required.</code><p class="paragraph"/>We can note the key (Required in our case) and the label parameter written in the <a href="http://en.wikipedia.org/wiki/Expression_Language" target="blank">expression language</a> (${label}). Scrolling down this file we can also find the message used by the Email AddressValidator:<p class="paragraph"/><code>EmailAddressValidator=The value of '${label}' is not a valid email address.</code><p class="paragraph"/>By default FormComponent provides 3 parameters for feedback message: input (the value that failed validation), label and name (this later is the id of the component).<p class="paragraph"/><blockquote class="warning">
Remember that component model is updated with the user input only if validation succeeds! As a consequence, we can't retrieve the wrong value inserted for a field from its model. Instead, we should use getValue() method of FormComponent class. (This method will be introduced in the example used in paragraph 10.2.5)
</blockquote><p class="paragraph"/><h3>Displaying feedback messages and filtering them</h3><p class="paragraph"/>To display feedback messages we must use component <code>org.apache.wicket.markup.html.panel.FeedbackPanel</code>. This component automatically reads all the feedback messages generated during form validation and displays them with an unordered list:<p class="paragraph"/><div class="code"><pre>&#60;ul class=<span class="java&#45;quote">"feedbackPanel"</span>&#62; 
	&#60;li class=<span class="java&#45;quote">"feedbackPanelERROR"</span>&#62; 
		&#60;span class=<span class="java&#45;quote">"feedbackPanelERROR"</span>&#62;Field 'Username' is required.&#60;/span&#62; 
	&#60;/li&#62; 
&#60;/ul&#62;</pre></div><p class="paragraph"/>CSS classes "feedbackPanel" and "feedbackPanelERROR" can be used in order to customize the style of the message list:<p class="paragraph"/><img border="0" class="center" src="../img/feedback-panel-style.png"></img><p class="paragraph"/>The component can be freely placed inside the page and we can set the maximum amount of displayed messages with the setMaxMessages() method.<p class="paragraph"/>Error messages can be filtered using three built-in filters:
<ul class="star">
<li><strong class="bold">ComponentFeedbackMessageFilter</strong>: shows only messages coming from a specific component.</li>
<li><strong class="bold">ContainerFeedbackMessageFilter</strong>: shows only messages coming from a specific container or from any of its children components.</li>
<li><strong class="bold">ErrorLevelFeedbackMessageFilter</strong>: shows only messages with a level of severity equals or greater than a given lower bound. Class FeedbackMessage defines a set of static constants to express different levels of severity: DEBUG, ERROR, WARNING, INFO, SUCCESS, etc.... Levels of severity for feedback messages are discussed in paragraph 10.2.6.</li>
</ul><p class="paragraph"/>These filters are intended to be used when there are more than one feedback panel (or more than one form) in the same page. We can pass a filter to a feedback panel via its constructor or using the setFilter method. Custom filters can be created implementing the IFeedbackMessageFilter interface. An example of custom filter is illustrated on page 89.<p class="paragraph"/><h3>Built-in validators</h3><p class="paragraph"/>Wicket already provides a number of built-in validators ready to be used. The following table is a short reference where validators are listed along with a brief description of what they do. The default feedback message used by each of them is reported as well:<p class="paragraph"/><h4>EmailAddressValidator</h4><p class="paragraph"/>Checks if input respects the format local-part&#64;domain.<p class="paragraph"/><strong class="bold">Message:</strong><p class="paragraph"/><code>The value of '${label}' is not a valid email address.</code><p class="paragraph"/><h4>UrlValidator</h4><p class="paragraph"/>Checks if input is a valid URL. We can specify in the constructor which protocols are allowed (http://, https://, and ftp://).<p class="paragraph"/><strong class="bold">Message:</strong><p class="paragraph"/><code>The value of '${label}' is not a valid URL.</code><p class="paragraph"/><h4>DateValidator</h4><p class="paragraph"/>Validator class that can be extended or used as a factory class to get date validators to check if a date is bigger than a lower bound (method minimum(Date min)), smaller than a upper bound (method maximum(Date max)) or inside a range (method range(Date min, Date max)).<p class="paragraph"/><strong class="bold">Messages:</strong><p class="paragraph"/><code>The value of '${label}' is less than the minimum of ${minimum}.</code><p class="paragraph"/><code>The value of '${label}' is larger than the maximum of ${maximum}.</code><p class="paragraph"/><code>The value of '${label}' is not between ${minimum} and ${maximum}.</code><p class="paragraph"/><h4>RangeValidator</h4><p class="paragraph"/>Validator class that can be extended or used as a factory class to get validators to check if a value is bigger than a given lower bound (method minimum(T min)), smaller than a upper bound (method maximum(T max)) or inside a range (method range(T min,T max)).<p class="paragraph"/>The type of the value is a generic subtype of java.lang.Comparable and must implement Serializable interface.<p class="paragraph"/><strong class="bold">Messages:</strong><p class="paragraph"/><code>The value of '${label}' must be at least ${minimum}.</code><p class="paragraph"/><code>The value of '${label}' must be at most ${maximum}.</code><p class="paragraph"/><code>The value of '${label}' must be between ${minimum} and ${maximum}.</code><p class="paragraph"/><h4>StringValidator</h4><p class="paragraph"/>Validator class that can be extended or used as a factory class to get validators to check if the length of a string value is bigger then a given lower bound (method minimumLength (int min)), smaller then a given upper bound (method maximumLength (int max)) or within a given range (method lengthBetween(int min, int max)).<p class="paragraph"/>To accept only string values consisting of exactly n characters, we must use method exactLength(int length).<p class="paragraph"/><strong class="bold">Messages:</strong><p class="paragraph"/><code>The value of '${label}' is shorter than the minimum of ${minimum} characters.</code><p class="paragraph"/><code>The value of '${label}' is longer than the maximum of ${maximum} characters.</code><p class="paragraph"/><code>The value of '${label}' is not between ${minimum} and ${maximum} characters long.</code><p class="paragraph"/><code>The value of '${label}' is not exactly ${exact} characters long.</code><p class="paragraph"/><h4>CreditCardValidator</h4><p class="paragraph"/>Checks if input is a valid credit card number. This validator supports some of the most popular credit cards (like “American Express", "MasterCard", “Visa” or “Diners Club”).<p class="paragraph"/><strong class="bold">Message:</strong><p class="paragraph"/><code>The credit card number is invalid.</code><p class="paragraph"/><h4>EqualPasswordInputValidator</h4><p class="paragraph"/>This validator checks if two password fields have the same value.<p class="paragraph"/><strong class="bold">Message:</strong><p class="paragraph"/><code>${label0} and ${label1} must be equal.</code><p class="paragraph"/><h3>Overriding standard feedback messages with custom bundles</h3><p class="paragraph"/>If we don't like the default validation feedback messages, we can override them providing custom properties files. In these files we can write our custom messages using the same keys of the messages we want to override. For example if we wanted to override the default message for invalid email addresses, our properties file would contain a line like this:<p class="paragraph"/><code>EmailAddressValidator=Man, your email address is not good!</code><p class="paragraph"/>As we will see in the next chapter, Wicket searches for custom properties files in various positions inside the application's class path, but for now we will consider just the properties file placed next to our application class. The name of this file must be equal to the name of our application class:<p class="paragraph"/><img border="0" class="center" src="../img/custom-properties-file.png"></img><p class="paragraph"/>The example project OverrideMailMessage overrides email validator's message with a new one which also reports the value that failed validation:<p class="paragraph"/><code>EmailAddressValidator=The value '${input}' inserted for field '${label}' is not a valid email address.</code><p class="paragraph"/><img border="0" class="center" src="../img/validation-error-message.png"></img><p class="paragraph"/><h3>Creating custom validators</h3><p class="paragraph"/>If our web application requires a complex validation logic and built-in validators are not enough, we can  implement our own custom validators. For example (project UsernameCustomValidator) suppose we are working on the registration page of our site where users can create their profile choosing their username. Our registration form should validate the new username checking if it was already chosen by another user. In a situation like this we may need to implement a custom validator that queries a specific data source to check if a username is already in use.<p class="paragraph"/>For the sake of simplicity, the validator of our example will check the given username against a fixed list of three existing usernames.<p class="paragraph"/>A custom validator must simply implement interface IValidator:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">public</span> class UsernameValidator <span class="java&#45;keyword">implements</span> IValidator&#60;<span class="java&#45;object">String</span>&#62; &#123;
	List&#60;<span class="java&#45;object">String</span>&#62; existingUsernames = Arrays.asList(<span class="java&#45;quote">"bigJack"</span>, <span class="java&#45;quote">"anonymous"</span>, <span class="java&#45;quote">"mrSmith"</span>);<p class="paragraph"/>	<span class="java&#45;keyword">public</span> void validate(IValidatable&#60;<span class="java&#45;object">String</span>&#62; validatable) &#123;
		<span class="java&#45;object">String</span> chosenUserName = validatable.getValue();<p class="paragraph"/>		<span class="java&#45;keyword">if</span>(existingUsernames.contains(chosenUserName))&#123;
			ValidationError error = <span class="java&#45;keyword">new</span> ValidationError(<span class="java&#45;keyword">this</span>);
			Random random = <span class="java&#45;keyword">new</span> Random();<p class="paragraph"/>			error.setVariable(<span class="java&#45;quote">"suggestedUserName"</span>, 
					validatable.getValue() + random.nextInt());
			validatable.error(error);
		&#125;
	&#125;	
&#125;</pre></div><p class="paragraph"/>The only method defined inside IValidator is validate(IValidatable&#60;T&#62; validatable) and is invoked during validation's step. Interface IValidatable represents the component being validated and it can be used to retrieve the component model (getModel()) or the value to validate (getValue()).<p class="paragraph"/>The custom validation logic is all inside IValidator's method validate. When validation fails a validator must use IValidatable's method error(IValidationError error) to generate the appropriate feedback message. In the code above we used the ValidationError class as convenience implementation of the IValidationError interface which represents the validation error that must be displayed to the user. This class provides a constructor that uses the class name of the validator in input as key for the resource to use as feedback message (i.e. 'UsernameValidator' in the example). If we want to specify more then one key to use to locate the error message, we can use method addKey(String key) of ValidationError class.<p class="paragraph"/>In our example when validation fails, we suggest a possible username concatenating the given input with a pseudo-random integer. This value is passed to the feedback message with a variable named suggestedUserName. The message is inside application's properties file:<p class="paragraph"/><code>UsernameValidator=The username '${input}' is already in use. Try with '${suggestedUserName}'</code><p class="paragraph"/>To provide further variables to our feedback message we can use method setVariable(String name, Object value) of class ValidationError as we did in our example.<p class="paragraph"/>The code of the home page of the project will be examined in the next paragraph after we have introduced the topic of flash messages.<p class="paragraph"/><h3>Using flash messages</h3><p class="paragraph"/>So far we have considered just the error messages generated during validation step. However Wicket's Component class provides a set of methods to explicitly generate feedback messages called flash messages. These methods are:
<ul class="star">
<li>debug(Serializable message)</li>
<li>info(Serializable message)</li>
<li>success(Serializable message)</li>
<li>warn(Serializable message)</li>
<li>error(Serializable message)</li>
<li>fatal(Serializable message)</li>
</ul><p class="paragraph"/>Each of these methods corresponds to a level of severity for the message. The list above is sorted by increasing level of severity.<p class="paragraph"/>In the example seen in the previous paragraph we have a form which uses success method to notify user when the inserted username is valid. Inside this form there are two FeedbackPanel components: one to display the error message produced by custom validator and the other one to display the success message. The code of the example page is the following:<p class="paragraph"/><strong class="bold">HTML:</strong><p class="paragraph"/><div class="code"><pre>&#60;body&#62;
	&#60;form wicket:id=<span class="java&#45;quote">"form"</span>&#62;
		Username: &#60;input type=<span class="java&#45;quote">"text"</span> wicket:id=<span class="java&#45;quote">"username"</span>/&#62;
		&#60;br/&#62;
		&#60;input type=<span class="java&#45;quote">"submit"</span>/&#62;
	&#60;/form&#62;
	&#60;div style=<span class="java&#45;quote">"color:green"</span> wicket:id=<span class="java&#45;quote">"succesMessage"</span>&#62;
	&#60;/div&#62;
	&#60;div style=<span class="java&#45;quote">"color:red"</span> wicket:id=<span class="java&#45;quote">"feedbackMessage"</span>&#62;
	&#60;/div&#62;
&#60;/body&#62;</pre></div><p class="paragraph"/><strong class="bold">Java code:</strong><p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">public</span> class HomePage <span class="java&#45;keyword">extends</span> WebPage &#123;<p class="paragraph"/>    <span class="java&#45;keyword">public</span> HomePage(<span class="java&#45;keyword">final</span> PageParameters parameters) &#123;	
	Form form = <span class="java&#45;keyword">new</span> Form(<span class="java&#45;quote">"form"</span>)&#123;
		@Override
		<span class="java&#45;keyword">protected</span> void onSubmit() &#123;
			<span class="java&#45;keyword">super</span>.onSubmit();
			success(<span class="java&#45;quote">"Username is good!"</span>);
		&#125;
	&#125;;<p class="paragraph"/>	TextField mail;<p class="paragraph"/>	form.add(mail = <span class="java&#45;keyword">new</span> TextField(<span class="java&#45;quote">"username"</span>, Model.of(<span class="java&#45;quote">""</span>)));
	mail.add(<span class="java&#45;keyword">new</span> UsernameValidator());<p class="paragraph"/>	add(<span class="java&#45;keyword">new</span> FeedbackPanel(<span class="java&#45;quote">"feedbackMessage"</span>, 
		<span class="java&#45;keyword">new</span> ExactErrorLevelFilter(FeedbackMessage.ERROR)));
	add(<span class="java&#45;keyword">new</span> FeedbackPanel(<span class="java&#45;quote">"succesMessage"</span>, 
		<span class="java&#45;keyword">new</span> ExactErrorLevelFilter(FeedbackMessage.SUCCESS)));<p class="paragraph"/>	add(form);
    &#125;<p class="paragraph"/>    class ExactErrorLevelFilter <span class="java&#45;keyword">implements</span> IFeedbackMessageFilter&#123;
    	<span class="java&#45;keyword">private</span> <span class="java&#45;object">int</span> errorLevel;<p class="paragraph"/>		<span class="java&#45;keyword">public</span> ExactErrorLevelFilter(<span class="java&#45;object">int</span> errorLevel)&#123;
			<span class="java&#45;keyword">this</span>.errorLevel = errorLevel;
		&#125;<p class="paragraph"/>		<span class="java&#45;keyword">public</span> <span class="java&#45;object">boolean</span> accept(FeedbackMessage message) &#123;
			<span class="java&#45;keyword">return</span> message.getLevel() == errorLevel;
		&#125;<p class="paragraph"/>    &#125;
    //UsernameValidator definition
    //&#8230;
&#125;</pre></div><p class="paragraph"/>The two feedback panels must be filtered in order to display just the messages with a given level of severity (ERROR for validator message and SUCCESS for form's flash message). Unfortunately the built-in message filter ErrorLevelFeedbackMessageFilter is not suitable for this task because its filter condition does not check for an exact error level (the given level is used as lower bound value). As a consequence, we had to build a custom filter (inner class ExactErrorLevelFilter) to accept only the desired severity level (see method accept of interface IFeedbackMessageFilter). 


<h2 id="forms2_3">12.3 Input value conversion</h2>
<p class="paragraph"/>Working with Wicket we will rarely need to worry about conversion between input values (which are strings because the underlying HTTP protocol) and Java types because in most cases the default conversion mechanism will be smart enough to infer the type of the model object and perform the proper conversion. However, sometimes we may need to work under the hood of this mechanism to make it properly work or to perform custom conversions. That's why this paragraph will illustrate how to control input value conversion.<p class="paragraph"/>The component that is responsible for converting input is the FormComponent itself with its convertInput() method. In order to convert its input a FormComponent must know the type of its model object. This parameter can be explicitly set with method setType(Class&#60;?&#62; type):<p class="paragraph"/><div class="code"><pre>//<span class="java&#45;keyword">this</span> field must receive an integer value
TextField integerField = <span class="java&#45;keyword">new</span> TextField(<span class="java&#45;quote">"number"</span>, <span class="java&#45;keyword">new</span> Model()).setType(<span class="java&#45;object">Integer</span>.class));</pre></div><p class="paragraph"/>If no type has been provided, FormComponent will try to ask its model for this information. The PropertyModel and CompoundPropertyModel models can use reflection to get the type of object model. By default, if FormComponent can not obtain the type of its model object in any way, it will consider it as a simple String.<p class="paragraph"/>Once FormComponent has determined the type of model object, it can look up for a converter, which is the entity in charge of converting input to Java object and vice versa. Converters are instances of <code>org.apache.wicket.util.convert.IConverter</code> interface and are registered by our application class on start up.<p class="paragraph"/>To get a converter for a specific type we must call method getConverter(Class&#60;C&#62; type) on the interface IConverterLocator returned by Application's method getConverterLocator():<p class="paragraph"/><div class="code"><pre>//retrieve converter <span class="java&#45;keyword">for</span> <span class="java&#45;object">Boolean</span> type
Application.get().getConverterLocator().getConverter(<span class="java&#45;object">Boolean</span>.class);</pre></div><p class="paragraph"/><blockquote class="note">
Components which are subclasses of AbstractSingleSelectChoice don't follow the schema illustrated above to convert user input.<p class="paragraph"/>These kinds of components (like DropDownChoice and RadioChoice1) use their choice render and their collection of possible choices to perform input conversion.
</blockquote><p class="paragraph"/><h3>Creating custom application-scoped converters</h3><p class="paragraph"/>The default converter locator used by Wicket is <code>org.apache.wicket.ConverterLocator</code>. This class provides converters for the most common Java types. Here we can see the converters registered inside its constructor:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">public</span> ConverterLocator()
&#123;
	set(<span class="java&#45;object">Boolean</span>.TYPE, BooleanConverter.INSTANCE);
	set(<span class="java&#45;object">Boolean</span>.class, BooleanConverter.INSTANCE);
	set(<span class="java&#45;object">Byte</span>.TYPE, ByteConverter.INSTANCE);
	set(<span class="java&#45;object">Byte</span>.class, ByteConverter.INSTANCE);
	set(<span class="java&#45;object">Character</span>.TYPE, CharacterConverter.INSTANCE);
	set(<span class="java&#45;object">Character</span>.class, CharacterConverter.INSTANCE);
	set(<span class="java&#45;object">Double</span>.TYPE, DoubleConverter.INSTANCE);
	set(<span class="java&#45;object">Double</span>.class, DoubleConverter.INSTANCE);
	set(<span class="java&#45;object">Float</span>.TYPE, FloatConverter.INSTANCE);
	set(<span class="java&#45;object">Float</span>.class, FloatConverter.INSTANCE);
	set(<span class="java&#45;object">Integer</span>.TYPE, IntegerConverter.INSTANCE);
	set(<span class="java&#45;object">Integer</span>.class, IntegerConverter.INSTANCE);
	set(<span class="java&#45;object">Long</span>.TYPE, LongConverter.INSTANCE);
	set(<span class="java&#45;object">Long</span>.class, LongConverter.INSTANCE);
	set(<span class="java&#45;object">Short</span>.TYPE, ShortConverter.INSTANCE);
	set(<span class="java&#45;object">Short</span>.class, ShortConverter.INSTANCE);
	set(Date.class, <span class="java&#45;keyword">new</span> DateConverter());
	set(Calendar.class, <span class="java&#45;keyword">new</span> CalendarConverter());
	set(java.sql.Date.class, <span class="java&#45;keyword">new</span> SqlDateConverter());
	set(java.sql.Time.class, <span class="java&#45;keyword">new</span> SqlTimeConverter());
	set(java.sql.Timestamp.class, <span class="java&#45;keyword">new</span> SqlTimestampConverter());
	set(BigDecimal.class, <span class="java&#45;keyword">new</span> BigDecimalConverter());
&#125;</pre></div><p class="paragraph"/>If we want to add more converters to our application, we can override Application's method newConverterLocator which is used by application class to build its converter locator.<p class="paragraph"/>To illustrate how to implement custom converters and use them in our application, we will build a form with two text field: one to input a regular expression pattern and another one to input a string value that will be split with the given pattern.<p class="paragraph"/>The first text field will have an instance of class java.util.regex.Pattern as model object. The final page will look like this (the code of this example is from the CustomConverter project):<p class="paragraph"/><img border="0" class="center" src="../img/regex-form.png"></img><p class="paragraph"/>The conversion between Pattern and String is quite straightforward. The code of our custom converter is the following:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">public</span> class RegExpPatternConverter <span class="java&#45;keyword">implements</span> IConverter&#60;Pattern&#62; &#123;
	@Override
	<span class="java&#45;keyword">public</span> Pattern convertToObject(<span class="java&#45;object">String</span> value, Locale locale) &#123;
		<span class="java&#45;keyword">return</span> Pattern.compile(value);
	&#125;<p class="paragraph"/>	@Override
	<span class="java&#45;keyword">public</span> <span class="java&#45;object">String</span> convertToString(Pattern value, Locale locale) &#123;
		<span class="java&#45;keyword">return</span> value.toString();
	&#125;
&#125;</pre></div><p class="paragraph"/>Methods declared by interface IConverter take as input a Locale parameter in order to deal with locale-sensitive data and conversions. We will learn more about locales and internationalization in chapter 12.<p class="paragraph"/>Once we have implemented our custom converter, we must override method newConverterLocator() inside our application class and tell it to add our new converter to the default set:<p class="paragraph"/><div class="code"><pre>@Override
	<span class="java&#45;keyword">protected</span> IConverterLocator newConverterLocator() &#123;
		ConverterLocator defaultLocator = <span class="java&#45;keyword">new</span> ConverterLocator();<p class="paragraph"/>		defaultLocator.set(Pattern.class, <span class="java&#45;keyword">new</span> RegExpPatternConverter());<p class="paragraph"/>		<span class="java&#45;keyword">return</span> defaultLocator;
	&#125;</pre></div><p class="paragraph"/>Finally, in the home page of the project we build the form which displays (with a flash message) the tokens obtained splitting the string with the given pattern:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">public</span> class HomePage <span class="java&#45;keyword">extends</span> WebPage &#123;
    <span class="java&#45;keyword">private</span> Pattern regExpPatter;
    <span class="java&#45;keyword">private</span> <span class="java&#45;object">String</span> stringToSplit;<p class="paragraph"/>    <span class="java&#45;keyword">public</span> HomePage(<span class="java&#45;keyword">final</span> PageParameters parameters) &#123;		
    	TextField mail;
	TextField stringToSplitTxt;<p class="paragraph"/>    	Form form = <span class="java&#45;keyword">new</span> Form(<span class="java&#45;quote">"form"</span>)&#123;
			@Override
			<span class="java&#45;keyword">protected</span> void onSubmit() &#123;
				<span class="java&#45;keyword">super</span>.onSubmit();
				<span class="java&#45;object">String</span> messageResult = <span class="java&#45;quote">"Tokens <span class="java&#45;keyword">for</span> the given string and pattern:&#60;br/&#62;"</span>;
				<span class="java&#45;object">String</span>&#91;&#93; tokens = regExpPatter.split(stringToSplit);<p class="paragraph"/>				<span class="java&#45;keyword">for</span> (<span class="java&#45;object">String</span> token : tokens) &#123;
					messageResult += <span class="java&#45;quote">"&#45; "</span> + token + <span class="java&#45;quote">"&#60;br/&#62;"</span>;
				&#125;				
				success(messageResult);
		&#125;
	&#125;;<p class="paragraph"/>		form.setDefaultModel(<span class="java&#45;keyword">new</span> CompoundPropertyModel(<span class="java&#45;keyword">this</span>));
		form.add(mail = <span class="java&#45;keyword">new</span> TextField(<span class="java&#45;quote">"regExpPatter"</span>));
		form.add(stringToSplitTxt = <span class="java&#45;keyword">new</span> TextField(<span class="java&#45;quote">"stringToSplit"</span>));
		add(<span class="java&#45;keyword">new</span> FeedbackPanel(<span class="java&#45;quote">"feedbackMessage"</span>).setEscapeModelStrings(<span class="java&#45;keyword">false</span>));<p class="paragraph"/>		add(form);
    &#125;
&#125;</pre></div><p class="paragraph"/><blockquote class="note">
If the user input can not be converted to the target type, FormComponent will generate the default error message “The value of '${label}' is not a valid ${type}.”. The bundle key for this message is IConverter.
</blockquote>


<h2 id="forms2_4">12.4 Validation with JSR 303</h2>
Standard JSR 303 defines a set of annotations and APIs to validate our domain objects at field-level. Wicket has introduced an experimental support for this standard since version 6.4.0 and with version 6.14.0 it has became an official Wicket model (named <code>wicket-bean-validation</code>).
In this paragraph we will see the basic steps needed to use JSR 303 validation in our Wicket application. Code snippets are from example project <code>JSR303validation</code>.<p class="paragraph"/>In the example application we have a form to insert the data for a new <code>Person</code> bean and its relative <code>Address</code>. The code for class <code>Person</code> is the following<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">public</span> class Person <span class="java&#45;keyword">implements</span> Serializable&#123;<p class="paragraph"/>	@NotNull
	<span class="java&#45;keyword">private</span> <span class="java&#45;object">String</span> name;<p class="paragraph"/>	//regular expression to validate an email address     
	@Pattern(regexp = <span class="java&#45;quote">"^&#91;_A&#45;Za&#45;z0&#45;9&#45;&#93;+(.&#91;_A&#45;Za&#45;z0&#45;9&#45;&#93;+)&#42;&#91;A&#45;Za&#45;z0&#45;9&#45;&#93;+(.&#91;A&#45;Za&#45;z0&#45;9&#45;&#93;+)&#42;((.&#91;A&#45;Za&#45;z&#93;&#123;2,&#125;)&#123;1&#125;$)"</span>)
	<span class="java&#45;keyword">private</span> <span class="java&#45;object">String</span> email;<p class="paragraph"/>	@Range(min = 18, max = 150)
	<span class="java&#45;keyword">private</span> <span class="java&#45;object">int</span> age;<p class="paragraph"/>	<code>Past </code>NotNull 
	<span class="java&#45;keyword">private</span> Date birthDay;<p class="paragraph"/>	@NotNull
	<span class="java&#45;keyword">private</span> Address address; 
&#125;</pre></div><p class="paragraph"/>You can note the JSR 303 annotations used in the code above to declare validation constraints on class fields. Class <code>Address</code> has the following code:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">public</span> class Address <span class="java&#45;keyword">implements</span> Serializable &#123;<p class="paragraph"/>	@NotNull
	<span class="java&#45;keyword">private</span> <span class="java&#45;object">String</span> city;<p class="paragraph"/>	@NotNull
	<span class="java&#45;keyword">private</span> <span class="java&#45;object">String</span> street;<p class="paragraph"/>	@Pattern(regexp = "&#92;&#92;d+<span class="java&#45;quote">", message = "</span>&#123;address.invalidZipCode&#125;")
	<span class="java&#45;keyword">private</span> <span class="java&#45;object">String</span> zipCode;
&#125;</pre></div><p class="paragraph"/>You might have noted that in class <code>Address</code> we have used annotation <code>Pattern using also attribute </code>message<code> which contains the key of the bundle to use for validation message. Our custom bundle is contained inside </code>HomePage.properties@:<p class="paragraph"/><div class="code"><pre>address.invalidZipCode=The inserted zip code is not valid.</pre></div><p class="paragraph"/>To tell Wicket to use JSR 303, we must register bean validator on Application's startup:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">public</span> class WicketApplication <span class="java&#45;keyword">extends</span> WebApplication &#123;
	@Override
	<span class="java&#45;keyword">public</span> void init()&#123;
		<span class="java&#45;keyword">super</span>.init();<p class="paragraph"/>		<span class="java&#45;keyword">new</span> BeanValidationConfiguration().configure(<span class="java&#45;keyword">this</span>);
	&#125;
&#125;</pre></div><p class="paragraph"/>The last step to harness JSR 303 annotations is to add validator <code>org.apache.wicket.bean.validation.PropertyValidator</code> to our corresponding form components:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">public</span> HomePage(<span class="java&#45;keyword">final</span> PageParameters parameters) &#123;
	<span class="java&#45;keyword">super</span>(parameters);<p class="paragraph"/>	setDefaultModel(<span class="java&#45;keyword">new</span> CompoundPropertyModel&#60;Person&#62;(<span class="java&#45;keyword">new</span> Person()));<p class="paragraph"/>	Form&#60;<span class="java&#45;object">Void</span>&#62; form = <span class="java&#45;keyword">new</span> Form&#60;<span class="java&#45;object">Void</span>&#62;(<span class="java&#45;quote">"form"</span>);<p class="paragraph"/>	form.add(<span class="java&#45;keyword">new</span> TextField(<span class="java&#45;quote">"name"</span>).add(<span class="java&#45;keyword">new</span> PropertyValidator()));
	form.add(<span class="java&#45;keyword">new</span> TextField(<span class="java&#45;quote">"email"</span>).add(<span class="java&#45;keyword">new</span> PropertyValidator()));
	form.add(<span class="java&#45;keyword">new</span> TextField(<span class="java&#45;quote">"age"</span>).add(<span class="java&#45;keyword">new</span> PropertyValidator()));
        //&#8230;
&#125;</pre></div><p class="paragraph"/>Now we can run our application an see that JSR 303 annotations are fully effective:<p class="paragraph"/><img border="0" class="center" src="../img/jsr303-form-validation.png"></img><p class="paragraph"/>


<h2 id="forms2_5">12.5 Submit form with an IFormSubmittingComponent</h2>
<p class="paragraph"/>Besides submitting forms with a standard HTML submit button, Wicket allows us to use special components which implement interface IFormSubmittingComponent. This entity is a subinterface of  IFormSubmitter:<p class="paragraph"/><img border="0" class="center" src="../img/class-diag-IFormSubmittingComponent.png"></img><p class="paragraph"/>At the beginning of this chapter we have seen that form processing is started by process method which takes as input an instance of IFormSubmitter. This parameter corresponds to the IFormSubmittingComponent clicked by a user to submit the form and it is null if we have used a standard HTML submit button (like we have done so far).<p class="paragraph"/>A submitting component is added to a form just like any other child component using method add(Component...).<p class="paragraph"/>A form can have any number of submitting components and we can specify which one among them is the default one by calling the Form's method setDefaultButton(IFormSubmittingComponent  component). The default submitter is the one that will be used when user presses 'Enter' key in a field of the form. In order to make the default button work, Wicket will add to our form a hidden &#60;div&#62; tag containing a text field and a submit button with some JavaScript code to trigger it:<p class="paragraph"/><div class="code"><pre>&#60;div style=<span class="java&#45;quote">"width:0px;height:0px;position:absolute;left:&#45;100px;top:&#45;100px;overflow:hidden"</span>&#62;
	&#60;input type=<span class="java&#45;quote">"text"</span> autocomplete=<span class="java&#45;quote">"off"</span>/&#62;
	&#60;input type=<span class="java&#45;quote">"submit"</span> name=<span class="java&#45;quote">"submit2"</span> onclick=<span class="java&#45;quote">" <span class="java&#45;keyword">var</span> b=document...."</span>/&#62;
&#60;/div&#62;</pre></div><p class="paragraph"/>Just like Wicket forms, interface IFormSubmitter defines methods onSubmit and onError. These two methods have the priority over the namesake methods of the form, meaning that when a form is submitted with an IFormSubmitter, the onSubmit of the submitter is called before the one of the form. Similarly, if validation errors occurs during the first step of form processing, submitter's method onError is called before the form's one.<p class="paragraph"/><blockquote class="note">
Starting with Wicket version 6.0 interface IFormSubmitter defines a further callback method called onAfterSubmit(). This method is called after form's method onSubmit() has been executed.
</blockquote><p class="paragraph"/><h3>Components Button and SubmitLink</h3><p class="paragraph"/>Component <code>org.apache.wicket.markup.html.form.Button</code> is a basic implementation of a form submitter. It can be used with either the &#60;input&#62; or &#60;button&#62; tags. The string model received as input by its constructor is used as button label and it will be the value of the markup attribute value.<p class="paragraph"/>In the following snippet we have a form with two submit buttons bound to an &#60;input&#62; tag. One of them is set as default button and both have a string model for the label:<p class="paragraph"/><strong class="bold">HTML:</strong><p class="paragraph"/><div class="code"><pre>&#60;body&#62;
		&#60;form wicket:id=<span class="java&#45;quote">"form"</span>&#62;
			Username: &#60;input type=<span class="java&#45;quote">"text"</span> wicket:id=<span class="java&#45;quote">"username"</span>/&#62;
			&#60;br/&#62;
			&#60;input type=<span class="java&#45;quote">"submit"</span> wicket:id=<span class="java&#45;quote">"submit1"</span>/&#62;
			&#60;input type=<span class="java&#45;quote">"submit"</span> wicket:id=<span class="java&#45;quote">"submit2"</span>/&#62;
		&#60;/form&#62;
&#60;/body&#62;</pre></div><p class="paragraph"/><strong class="bold">Java code:</strong><p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">public</span> class HomePage <span class="java&#45;keyword">extends</span> WebPage &#123;<p class="paragraph"/>    <span class="java&#45;keyword">public</span> HomePage(<span class="java&#45;keyword">final</span> PageParameters parameters) &#123;		
		Form form = <span class="java&#45;keyword">new</span> Form(<span class="java&#45;quote">"form"</span>);<p class="paragraph"/>     	form.add(<span class="java&#45;keyword">new</span> TextField(<span class="java&#45;quote">"username"</span>, Model.of(<span class="java&#45;quote">""</span>)));
    	form.add(<span class="java&#45;keyword">new</span> Button(<span class="java&#45;quote">"submit1"</span>, Model.of(<span class="java&#45;quote">"First submitter"</span>)));
		Button secondSubmitter;
		form.add(secondSubmitter = <span class="java&#45;keyword">new</span> Button(<span class="java&#45;quote">"submit2"</span>, Model.of(<span class="java&#45;quote">"Second submitter"</span>)));<p class="paragraph"/>    	form.setDefaultButton(secondSubmitter);
		add(form);
    &#125;
&#125;</pre></div><p class="paragraph"/><strong class="bold">Generated markup:</strong><p class="paragraph"/><div class="code"><pre>&#60;form wicket:id=<span class="java&#45;quote">"form"</span> id=<span class="java&#45;quote">"form1"</span> method=<span class="java&#45;quote">"post"</span> action=<span class="java&#45;quote">"?0&#45;1.IFormSubmitListener&#45;form"</span>&#62;
   &#60;div&#62;
      &#8230;
      &#60;!&#45;&#45; Code generated by Wicket to handle the <span class="java&#45;keyword">default</span> button &#45;&#45;&#62;
      &#8230;
   &#60;/div&#62;			
   Username: &#60;input type=<span class="java&#45;quote">"text"</span> wicket:id=<span class="java&#45;quote">"username"</span> value=<span class="java&#45;quote">""</span> name=<span class="java&#45;quote">"username"</span>/&#62;
   &#60;br/&#62;
   &#60;input type=<span class="java&#45;quote">"submit"</span> wicket:id=<span class="java&#45;quote">"submit1"</span> name=<span class="java&#45;quote">"submit1"</span> id=<span class="java&#45;quote">"submit13"</span> value=<span class="java&#45;quote">"First submitter"</span>/&#62;
   &#60;input type=<span class="java&#45;quote">"submit"</span> wicket:id=<span class="java&#45;quote">"submit2"</span> name=<span class="java&#45;quote">"submit2"</span> id=<span class="java&#45;quote">"submit22"</span> value=<span class="java&#45;quote">"Second submitter"</span>/&#62;
&#60;/form&#62;</pre></div><p class="paragraph"/>Another component that can be used to submit a form is <code>org.apache.wicket.markup.html.form.SubmitLink</code>. This component uses JavaScript to submit the form. Like the name suggests, the component can be used with the &#60;a&#62; tag but it can be also bound to any other tag that supports the event handler onclick. When used with the &#60;a&#62; tag, the JavaScript code needed to submit the form will be placed inside href attribute while with other tags the script will go inside the event handler onclick.<p class="paragraph"/>A notable difference between this component and Button is that SubmitLink can be placed outside the form it must submit. In this case we must specify the form to submit in its constructor:<p class="paragraph"/><strong class="bold">HTML:</strong><p class="paragraph"/><div class="code"><pre>&#60;html xmlns:wicket=<span class="java&#45;quote">"http://wicket.apache.org"</span>&#62;
&#60;head&#62;
	&#60;/head&#62;
	&#60;body&#62;
	&#60;form wicket:id=<span class="java&#45;quote">"form"</span>&#62;
			Password: &#60;input type=<span class="java&#45;quote">"password"</span> wicket:id=<span class="java&#45;quote">"password"</span>/&#62;
			&#60;br/&#62;					
		&#60;/form&#62;
		&#60;button wicket:id=<span class="java&#45;quote">"externalSubmitter"</span>&#62;
			Submit
		&#60;/button&#62;
	&#60;/body&#62;
&#60;/html&#62;</pre></div><p class="paragraph"/><strong class="bold">Java code:</strong><p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">public</span> class HomePage <span class="java&#45;keyword">extends</span> WebPage &#123;<p class="paragraph"/>    <span class="java&#45;keyword">public</span> HomePage(<span class="java&#45;keyword">final</span> PageParameters parameters) &#123;		
		Form form = <span class="java&#45;keyword">new</span> Form(<span class="java&#45;quote">"form"</span>);<p class="paragraph"/>		form.add(<span class="java&#45;keyword">new</span> PasswordTextField(<span class="java&#45;quote">"password"</span>, Model.of(<span class="java&#45;quote">""</span>)));
		//specify the form to submit
		add(<span class="java&#45;keyword">new</span> SubmitLink(<span class="java&#45;quote">"externalSubmitter"</span>, form));
		add(form);
    &#125;
&#125;</pre></div><p class="paragraph"/><h3>Disabling default form processing</h3><p class="paragraph"/>With an IFormSubmittingComponent we can choose to skip the default form submission process  by setting the appropriate flag to false with the setDefaultFormProcessing method. When the default form processing is disabled only the submitter's onSubmit is called while form's validation and models updating are skipped.<p class="paragraph"/>This can be useful if we want to implement a “Cancel” button on our form which redirects user to another page without validating his/her input.<p class="paragraph"/>When we set this flag to false we can decide to manually invoke the form processing by calling the process(IFormSubmittingComponent) method.


<h2 id="forms2_6">12.6 Nested forms</h2>
<p class="paragraph"/>As you might already known, HTLM doesn't allow to have nested forms. However with Wicket we can overcome this limitation by adding one or more form components to a parent form.<p class="paragraph"/>This can be useful if we want to split a big form into smaller ones in order to reuse them and to better distribute responsibilities among different components.
Forms can be nested to an arbitrary level:<p class="paragraph"/><div class="code"><pre>&#60;form wicket:id=<span class="java&#45;quote">"outerForm"</span>&#62; 
	&#8230;
	&#60;form wicket:id=<span class="java&#45;quote">"innerForm"</span>&#62; 
		&#8230;
		&#60;form wicket:id=<span class="java&#45;quote">"veryInnerForm"</span>&#62;
			&#8230;
		&#60;/form&#62; 
	&#60;/form&#62; 
&#60;/form&#62;</pre></div><p class="paragraph"/>When a form is submitted also its nested forms are submitted and they participate in the validation step. This means that if a nested form contains invalid input values, the outer form won't be submitted. On the contrary, nested forms can be singularly submitted without depending on the status of their outer form.<p class="paragraph"/>To submit a parent form when one of its children forms is submitted, we must override its method wantSubmitOnNestedFormSubmit and make it return true. 


<h2 id="forms2_7">12.7 Multi-line text input</h2>
<p class="paragraph"/>HTML provides a multi-line text input control with &#60;textarea&#62; tag. The Wicket counterpart for this kind of control is <code>org.apache.wicket.markup.html.form.TextArea</code> component:<p class="paragraph"/><strong class="bold">HTML:</strong><p class="paragraph"/><div class="code"><pre>&#60;textarea wicket:id=<span class="java&#45;quote">"description"</span> rows=<span class="java&#45;quote">"5"</span> cols=<span class="java&#45;quote">"40"</span>&#62;&#60;/textarea&#62;</pre></div><p class="paragraph"/><strong class="bold">Java code:</strong><p class="paragraph"/><div class="code"><pre>form.add(<span class="java&#45;keyword">new</span> TextArea(<span class="java&#45;quote">"description"</span>, Model.of(<span class="java&#45;quote">""</span>)));</pre></div><p class="paragraph"/>Component TextArea is used just like any other single-line text field. To specify the size of the text area we can write attributes rows and cols directly in the markup file or we can create new attribute modifiers and add them to our TextArea component.


<h2 id="forms2_8">12.8 File upload</h2>
<p class="paragraph"/>Wicket supports file uploading with the FileUploadField component which must be used with the &#60;input&#62; tag whose type attribute must be set to "file". In order to send a file on form submission we must enable multipart mode calling MultiPart(true)on our form.<p class="paragraph"/>In the next example (project UploadSingleFile) we will see a form which allows users to upload a file into the temporary directory of the server (path /tmp on Unix/Linux systems):<p class="paragraph"/><strong class="bold">HTML:</strong><p class="paragraph"/><div class="code"><pre>&#60;html&#62;
	&#60;head&#62;
	&#60;/head&#62;
	&#60;body&#62;
	&#60;h1&#62;Upload your file here!&#60;/h1&#62;
	&#60;form wicket:id=<span class="java&#45;quote">"form"</span>&#62;
		&#60;input type=<span class="java&#45;quote">"file"</span> wicket:id=<span class="java&#45;quote">"fileUploadField"</span>/&#62; 
		&#60;input type=<span class="java&#45;quote">"submit"</span> value=<span class="java&#45;quote">"Upload"</span>/&#62;
	&#60;/form&#62;
	&#60;div wicket:id=<span class="java&#45;quote">"feedbackPanel"</span>&#62;
	&#60;/div&#62;
	&#60;/body&#62;
&#60;/html&#62;</pre></div><p class="paragraph"/><strong class="bold">Java code:</strong><p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">public</span> class HomePage <span class="java&#45;keyword">extends</span> WebPage &#123;
   <span class="java&#45;keyword">private</span> FileUploadField fileUploadField;<p class="paragraph"/>    <span class="java&#45;keyword">public</span> HomePage(<span class="java&#45;keyword">final</span> PageParameters parameters) &#123;
    	fileUploadField = <span class="java&#45;keyword">new</span> FileUploadField(<span class="java&#45;quote">"fileUploadField"</span>);<p class="paragraph"/>    	Form form = <span class="java&#45;keyword">new</span> Form(<span class="java&#45;quote">"form"</span>)&#123;
    		@Override
    		<span class="java&#45;keyword">protected</span> void onSubmit() &#123;
    		  <span class="java&#45;keyword">super</span>.onSubmit();<p class="paragraph"/>    		  FileUpload fileUpload = fileUploadField.getFileUpload();<p class="paragraph"/>    		    <span class="java&#45;keyword">try</span> &#123;
			File file = <span class="java&#45;keyword">new</span> File(<span class="java&#45;object">System</span>.getProperty(<span class="java&#45;quote">"java.io.tmpdir"</span>) + <span class="java&#45;quote">"/"</span> +
    						fileUpload.getClientFileName());<p class="paragraph"/>			    fileUpload.writeTo(file);
		        &#125; <span class="java&#45;keyword">catch</span> (IOException e) &#123;
			   e.printStackTrace();
			 &#125;
    		&#125;
    	&#125;;<p class="paragraph"/>	form.setMultiPart(<span class="java&#45;keyword">true</span>);
	//set a limit <span class="java&#45;keyword">for</span> uploaded file's size
	form.setMaxSize(Bytes.kilobytes(100));
	form.add(fileUploadField);
	add(<span class="java&#45;keyword">new</span> FeedbackPanel(<span class="java&#45;quote">"feedbackPanel"</span>));
	add(form);
    &#125;
&#125;</pre></div><p class="paragraph"/>The code that copies the uploaded file to the temporary directory is inside the onSubmit method of the Form class. The uploaded file is handled with an instance of class FileUpload returned by the  getFileUpload() method of the FileUploadField class. This class provides a set of methods to perform some common tasks like getting the name of the uploaded file (getClientFileName()), coping the file into a directory (writeTo(destinationFile)), calculating file digest (getDigest (digestAlgorithm)) and so on.<p class="paragraph"/>Form component can limit the size for uploaded files using its setMaxSize(size) method. In the example we have set this limit to 100 kb to prevent users from uploading files bigger than this size.<p class="paragraph"/><blockquote class="note">
The maximum size for uploaded files can also be set at application's level using the setDefaultMaximumUploadSize(Bytes maxSize) method of the IApplicationSettings interface:<p class="paragraph"/><div class="code"><pre>@Override
<span class="java&#45;keyword">public</span> void init()
&#123;
 getApplicationSettings().setDefaultMaximumUploadSize(Bytes.kilobytes(100));  
&#125;</pre></div>
</blockquote><p class="paragraph"/><h3>Upload multiple files</h3><p class="paragraph"/>If we need to upload multiple files at once and our clients support HTML5, we can still use FileUploadField adding attribute "multiple" to its tag. If we can not rely on HTML5, we can use the MultiFileUploadField component which allows the user to upload an arbitrary number of files using a JavaScript-based solution.
An example showing how to use this component can be found in Wicket module wicket-examples in file MultiUploadPage.java. The live example is hosted at <a href="http://www.wicket-library.com/wicket-examples-6.0.x/upload/multi" target="blank">http://www.wicket-library.com/wicket-examples-6.0.x/upload/multi</a> .


<h2 id="forms2_9">12.9 Creating complex form components with FormComponentPanel</h2>
<p class="paragraph"/>In chapter 3.2.2 we have seen how to use class Panel to create custom components with their own markup and with an arbitrary number of children components.<p class="paragraph"/>While it's perfectly legal to use Panel also to group form components, the resulting component won't be itself a form component and it won't participate in the form's submission workflow.<p class="paragraph"/>This could be a strong limitation if the custom component needs to coordinate its children during sub-tasks like input conversion or model updating. That's why in Wicket we have the <code>org.apache.wicket.markup.html.form.FormComponentPanel</code> component which combines the features of a Panel (it has its own markup file) and a FormComponent (it is a subclass of FormComponent).<p class="paragraph"/>A typical scenario in which we may need to implement a custom FormComponentPanel is when our web application and its users work with different units of measurement for the same data.<p class="paragraph"/>To illustrate this possible scenario, let's consider a form where a user can insert a  temperature that will be recorded after being converted to Kelvin degrees (see the example project CustomForm ComponentPanel).<p class="paragraph"/>The Kelvin scale is wildly adopted among the scientific community and it is one of the seven base units of the <a href="http://en.wikipedia.org/wiki/International_System_of_Units" target="blank">International System of Units</a> , so it makes perfect sense to store temperatures expressed with this unit of measurement.<p class="paragraph"/>However, in our everyday life we still use other temperature scales like Celsius or Fahrenheit, so it would be nice to have a component which internally works with Kelvin degrees and automatically applies conversion between Kelvin temperature scale and the one adopted by the user.<p class="paragraph"/>In order to implement such a component, we can make a subclass of FormComponentPanel and leverage the convertInput and onBeforeRender methods: in the implementation of the convertInput method we will convert input value to Kelvin degrees while in the implementation of onBeforeRender method we will take care of converting the Kelvin value to the temperature scale adopted by the user.<p class="paragraph"/>Our custom component will contain two children components: a text field to let user insert and edit a temperature value and a label to display the letter corresponding to user's temperature scale (F for Fahrenheit and C for Celsius). The resulting markup file is the following:<p class="paragraph"/><div class="code"><pre>&#60;html&#62;
&#60;head&#62;
&#60;/head&#62;
&#60;body&#62;
	&#60;wicket:panel&#62;
		Registered temperature: &#60;input size=<span class="java&#45;quote">"3"</span> maxlength=<span class="java&#45;quote">"3"</span>         
                             wicket:id=<span class="java&#45;quote">"registeredTemperature"</span>/&#62; 
		&#60;label wicket:id=<span class="java&#45;quote">"mesuramentUnit"</span>&#62;&#60;/label&#62; 
	&#60;/wicket:panel&#62;
&#60;/body&#62;
&#60;/html&#62;</pre></div><p class="paragraph"/>As shown in the markup above FormComponentPanel uses the same &#60;wicket:panel&#62; tag used by Panel to define its markup. Now let's see the Java code of the new form component starting with the onInitialize() method:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">public</span> class TemperatureDegreeField <span class="java&#45;keyword">extends</span> FormComponentPanel&#60;<span class="java&#45;object">Double</span>&#62; &#123;<p class="paragraph"/>	<span class="java&#45;keyword">private</span> TextField&#60;<span class="java&#45;object">Double</span>&#62; userDegree;<p class="paragraph"/>	<span class="java&#45;keyword">public</span> TemperatureDegreeField(<span class="java&#45;object">String</span> id) &#123;
		<span class="java&#45;keyword">super</span>(id);		
	&#125;<p class="paragraph"/>	<span class="java&#45;keyword">public</span> TemperatureDegreeField(<span class="java&#45;object">String</span> id, IModel&#60;<span class="java&#45;object">Double</span>&#62; model) &#123;
		<span class="java&#45;keyword">super</span>(id, model);		
	&#125;<p class="paragraph"/>	@Override
	<span class="java&#45;keyword">protected</span> void onInitialize() &#123;
		<span class="java&#45;keyword">super</span>.onInitialize();<p class="paragraph"/>	     AbstractReadOnlyModel&#60;<span class="java&#45;object">String</span>&#62; labelModel=<span class="java&#45;keyword">new</span> AbstractReadOnlyModel&#60;<span class="java&#45;object">String</span>&#62;()&#123;
			@Override
			<span class="java&#45;keyword">public</span> <span class="java&#45;object">String</span> getObject() &#123;
				<span class="java&#45;keyword">if</span>(getLocale().equals(Locale.US))
					<span class="java&#45;keyword">return</span> <span class="java&#45;quote">"°F"</span>;
				<span class="java&#45;keyword">return</span> <span class="java&#45;quote">"°C"</span>;
			&#125;
		&#125;;<p class="paragraph"/>		add(<span class="java&#45;keyword">new</span> Label(<span class="java&#45;quote">"mesuramentUnit"</span>, labelModel));
		add(userDegree=<span class="java&#45;keyword">new</span> TextField&#60;<span class="java&#45;object">Double</span>&#62;(<span class="java&#45;quote">"registeredTemperature"</span>, <span class="java&#45;keyword">new</span> 
                           Model&#60;<span class="java&#45;object">Double</span>&#62;()));
		userDegree.setType(<span class="java&#45;object">Double</span>.class);
	&#125;</pre></div><p class="paragraph"/>Inside the onInitialize method we have created a read-only model for the label that displays the letter corresponding to the user's temperature scale. To determinate which temperature scale is in use, we retrieve the Locale from the session by calling Component's getLocale() method (we will talk more about this method in chapter 12). Then, if locale is the one corresponding to the United States, the chosen scale will be Fahrenheit, otherwise it will be considered as Celsius.<p class="paragraph"/>In the final part of onInitialize() we add the two components to our custom form component. You may have noticed that we have explicitly set the type of model object for the text field to double. This is necessary as the starting model object is a null reference and this prevents the component from automatically determining the type of its model object.<p class="paragraph"/>Now we can look at the rest of the code containing the convertInput and onBeforeRender methods:<p class="paragraph"/><div class="code"><pre>// continued example
	@Override
	<span class="java&#45;keyword">protected</span> void convertInput() &#123;
		<span class="java&#45;object">Double</span> userDegreeVal = userDegree.getConvertedInput();
		<span class="java&#45;object">Double</span> kelvinDegree;<p class="paragraph"/>		<span class="java&#45;keyword">if</span>(getLocale().equals(Locale.US))&#123;
			kelvinDegree = userDegreeVal +  459.67;
			BigDecimal bdKelvin = <span class="java&#45;keyword">new</span> BigDecimal(kelvinDegree);
			BigDecimal fraction = <span class="java&#45;keyword">new</span> BigDecimal(5).divide(<span class="java&#45;keyword">new</span> BigDecimal(9));<p class="paragraph"/>			kelvinDegree = bdKelvin.multiply(fraction).doubleValue();
		&#125;<span class="java&#45;keyword">else</span>&#123;
			kelvinDegree = userDegreeVal + 273.15;
		&#125;<p class="paragraph"/>		setConvertedInput(kelvinDegree);
	&#125;<p class="paragraph"/>	@Override
	<span class="java&#45;keyword">protected</span> void onBeforeRender() &#123;
		<span class="java&#45;keyword">super</span>.onBeforeRender();<p class="paragraph"/>		<span class="java&#45;object">Double</span> kelvinDegree = (<span class="java&#45;object">Double</span>) getDefaultModelObject();		
		<span class="java&#45;object">Double</span> userDegreeVal = <span class="java&#45;keyword">null</span>;<p class="paragraph"/>		<span class="java&#45;keyword">if</span>(kelvinDegree == <span class="java&#45;keyword">null</span>) <span class="java&#45;keyword">return</span>;<p class="paragraph"/>		<span class="java&#45;keyword">if</span>(getLocale().equals(Locale.US))&#123;
			BigDecimal bdKelvin = <span class="java&#45;keyword">new</span> BigDecimal(kelvinDegree);
			BigDecimal fraction = <span class="java&#45;keyword">new</span> BigDecimal(9).divide(<span class="java&#45;keyword">new</span> BigDecimal(5));<p class="paragraph"/>			kelvinDegree = bdKelvin.multiply(fraction).doubleValue();
			userDegreeVal = kelvinDegree &#45; 459.67;
		&#125;<span class="java&#45;keyword">else</span>&#123;
			userDegreeVal = kelvinDegree &#45; 273.15;
		&#125;<p class="paragraph"/>		userDegree.setModelObject(userDegreeVal);
	&#125;
&#125;</pre></div><p class="paragraph"/>Since our component does not directly receive the user input, convertInput() must read this value from the inner text field using FormComponent's getConvertedInput() method which returns the input value already converted to the type specified for the component (Double in our case). Once we have the user input we convert it to kelvin degrees and we use the resulting value to set the converted input for our custom component (using method setConvertedInput(T convertedInput)).<p class="paragraph"/>Method onBeforeRender() is responsible for synchronizing the model of the inner textfield with the model of our custom component. To do this we retrieve the model object of the custom component with the getDefaultModelObject() method, then we convert it to the temperature scale adopted by the user and finally we use this value to set the model object of the text field.


<h2 id="forms2_10">12.10 Stateless form</h2>
<p class="paragraph"/>In chapter 6 we have seen how Wicket pages can be divided into two categories: stateful and stateless. Pages that are stateless don't need to be stored in the user session and they should be used  when we don't need to save any user data in the user session (for example in the public area of a site).<p class="paragraph"/>Besides saving resources on server-side, stateless pages can be adopted to improve user experience and to avoid security weaknesses. A typical situation where a stateless page can bring these benefits is when we have to implement a login page.<p class="paragraph"/>For this kind of page we might encounter two potential problems if we chose to use a stateful page. The first problem occurs when the user tries to login without a valid session assigned to him. This could happen if the user leaves the login page opened for a period of time bigger than the session's timeout and then he decides to log in. Under these conditions the user will be redirected to a 'Page expired' error page, which is not exactly a nice thing for user experience.<p class="paragraph"/>The second problem occurs when a malicious user or a web crawler program attempts to login into our web application, generating a huge number of page versions and consequently increasing the size of the user session.<p class="paragraph"/>To avoid these kinds of problems we should build a stateless login page which does not depend on a user session. Wicket provides a special version of the Form component called StatelessForm which is stateless by default (i.e its method getStatelessHint() returns true), hence it's an ideal solution when we want to build a stateless page with a form. A possible implementation of our login form is the following (example project StatelessLoginForm):<p class="paragraph"/><strong class="bold">HTML:</strong><p class="paragraph"/><div class="code"><pre>&#60;html&#62;
   &#60;head&#62;
      &#60;meta charset=<span class="java&#45;quote">"utf&#45;8"</span> /&#62;
   &#60;/head&#62;
   &#60;body&#62;
      &#60;div&#62;Session is &#60;b wicket:id=<span class="java&#45;quote">"sessionType"</span>&#62;&#60;/b&#62;&#60;/div&#62;
      &#60;br/&#62;
      &#60;div&#62;Type 'user' as correct credentials&#60;/div&#62;
      &#60;form wicket:id=<span class="java&#45;quote">"form"</span>&#62;
         &#60;fieldset&#62;
            Username: &#60;input type=<span class="java&#45;quote">"text"</span> wicket:id=<span class="java&#45;quote">"username"</span>/&#62; &#60;br/&#62;
            Password: &#60;input type=<span class="java&#45;quote">"password"</span> wicket:id=<span class="java&#45;quote">"password"</span>/&#62;&#60;br/&#62;
            &#60;input type=<span class="java&#45;quote">"submit"</span>/&#62;
         &#60;/fieldset&#62;
      &#60;/form&#62;
      &#60;br/&#62;
      &#60;div wicket:id=<span class="java&#45;quote">"feedbackPanel"</span>&#62;&#60;/div&#62;
   &#60;/body&#62;
&#60;/html&#62;</pre></div><p class="paragraph"/><strong class="bold">Java code:</strong><p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">public</span> class HomePage <span class="java&#45;keyword">extends</span> WebPage &#123;
    <span class="java&#45;keyword">private</span> Label sessionType;
    <span class="java&#45;keyword">private</span> <span class="java&#45;object">String</span> password;
    <span class="java&#45;keyword">private</span> <span class="java&#45;object">String</span> username;<p class="paragraph"/>    <span class="java&#45;keyword">public</span> HomePage(<span class="java&#45;keyword">final</span> PageParameters parameters) &#123;
       StatelessForm form = <span class="java&#45;keyword">new</span> StatelessForm(<span class="java&#45;quote">"form"</span>)&#123;
         @Override
         <span class="java&#45;keyword">protected</span> void onSubmit() &#123;
            //sign in <span class="java&#45;keyword">if</span> username and password are “user”
            <span class="java&#45;keyword">if</span>(<span class="java&#45;quote">"user"</span>.equals(username) &#38;&#38; username.equals(password))
               info(<span class="java&#45;quote">"Username and password are correct!"</span>);
            <span class="java&#45;keyword">else</span>
               error(<span class="java&#45;quote">"Wrong username or password"</span>);
         &#125;
      &#125;;<p class="paragraph"/>      form.add(<span class="java&#45;keyword">new</span> PasswordTextField(<span class="java&#45;quote">"password"</span>));
      form.add(<span class="java&#45;keyword">new</span> TextField(<span class="java&#45;quote">"username"</span>));<p class="paragraph"/>      add(form.setDefaultModel(<span class="java&#45;keyword">new</span> CompoundPropertyModel(<span class="java&#45;keyword">this</span>)));<p class="paragraph"/>      add(sessionType = <span class="java&#45;keyword">new</span> Label(<span class="java&#45;quote">"sessionType"</span>, Model.of(<span class="java&#45;quote">""</span>)));
      add(<span class="java&#45;keyword">new</span> FeedbackPanel(<span class="java&#45;quote">"feedbackPanel"</span>));
    &#125;<p class="paragraph"/>    @Override
    <span class="java&#45;keyword">protected</span> void onBeforeRender() &#123;
       <span class="java&#45;keyword">super</span>.onBeforeRender();<p class="paragraph"/>       <span class="java&#45;keyword">if</span>(getSession().isTemporary())
          sessionType.setDefaultModelObject(<span class="java&#45;quote">"temporary"</span>);
       <span class="java&#45;keyword">else</span>
          sessionType.setDefaultModelObject(<span class="java&#45;quote">"permanent"</span>);
    &#125;
&#125;</pre></div><p class="paragraph"/>Label sessionType shows if current session is temporary or not and is set inside onBeforeRender(): if our page is really stateless the session will be always temporary. We have also inserted a feedback panel in the home page that shows if the credentials are correct. This was done to make the example form more interactive.


<h2 id="forms2_11">12.11 Working with radio buttons and checkboxes</h2>
<p class="paragraph"/>In this paragraph we will see which components can be used to handle HTML radio buttons and checkboxes. Both these input elements are usually grouped together to display a list of possible choices:<p class="paragraph"/><img border="0" class="center" src="../img/choice-form-screenshot.png"></img><p class="paragraph"/>A check box can be used as single component to set a boolean property. For this purpose Wicket provides the <code>org.apache.wicket.markup.html.form.CheckBox</code> component which must be attached to &#60;input type="checkbox".../&#62; tag. In the next example (project SingleCheckBox) we will consider a form similar to the one used in paragraph 9.5 to edit a Person object, but with an additional checkbox to let the user decide if she wants to subscribe to our mailing list or not. The form uses the following bean as backing object:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">public</span> class RegistrationInfo <span class="java&#45;keyword">implements</span> Serializable &#123;<p class="paragraph"/>	<span class="java&#45;keyword">private</span> <span class="java&#45;object">String</span> name;
	<span class="java&#45;keyword">private</span> <span class="java&#45;object">String</span> surname;
	<span class="java&#45;keyword">private</span> <span class="java&#45;object">String</span> address;
	<span class="java&#45;keyword">private</span> <span class="java&#45;object">String</span> email;
	<span class="java&#45;keyword">private</span> <span class="java&#45;object">boolean</span> subscribeList;<p class="paragraph"/>	/&#42;Getters and setters&#42;/
&#125;</pre></div><p class="paragraph"/>The markup and the code for this example are the following:<p class="paragraph"/><strong class="bold">HTML:</strong><p class="paragraph"/><div class="code"><pre>&#60;form wicket:id=<span class="java&#45;quote">"form"</span>&#62;		
		&#60;div style=<span class="java&#45;quote">"display: table;"</span>&#62;
			&#60;div style=<span class="java&#45;quote">"display: table&#45;row;"</span>&#62;
				&#60;div style=<span class="java&#45;quote">"display: table&#45;cell;"</span>&#62;Name: &#60;/div&#62;
				&#60;div style=<span class="java&#45;quote">"display: table&#45;cell;"</span>&#62;
					&#60;input type=<span class="java&#45;quote">"text"</span> wicket:id=<span class="java&#45;quote">"name"</span>/&#62; 
				&#60;/div&#62;	
			&#60;/div&#62;
			&#60;div style=<span class="java&#45;quote">"display: table&#45;row;"</span>&#62;
				&#60;div style=<span class="java&#45;quote">"display: table&#45;cell;"</span>&#62;Surname: &#60;/div&#62;
				&#60;div style=<span class="java&#45;quote">"display: table&#45;cell;"</span>&#62;
					&#60;input type=<span class="java&#45;quote">"text"</span> wicket:id=<span class="java&#45;quote">"surname"</span>/&#62;
				&#60;/div&#62;	
			&#60;/div&#62;
			&#60;div style=<span class="java&#45;quote">"display: table&#45;row;"</span>&#62;
				&#60;div style=<span class="java&#45;quote">"display: table&#45;cell;"</span>&#62;Address: &#60;/div&#62;
				&#60;div style=<span class="java&#45;quote">"display: table&#45;cell;"</span>&#62;
					&#60;input type=<span class="java&#45;quote">"text"</span> wicket:id=<span class="java&#45;quote">"address"</span>/&#62;
				&#60;/div&#62;	
			&#60;/div&#62;
			&#60;div style=<span class="java&#45;quote">"display: table&#45;row;"</span>&#62;
				&#60;div style=<span class="java&#45;quote">"display: table&#45;cell;"</span>&#62;Email: &#60;/div&#62;
				&#60;div style=<span class="java&#45;quote">"display: table&#45;cell;"</span>&#62;
					&#60;input type=<span class="java&#45;quote">"text"</span> wicket:id=<span class="java&#45;quote">"email"</span>/&#62;
				&#60;/div&#62;
			&#60;/div&#62;
			&#60;div style=<span class="java&#45;quote">"display: table&#45;row;"</span>&#62;
				&#60;div style=<span class="java&#45;quote">"display: table&#45;cell;"</span>&#62;Subscribe list:&#60;/div&#62;
				&#60;div style=<span class="java&#45;quote">"display: table&#45;cell;"</span>&#62;
					&#60;input type=<span class="java&#45;quote">"checkbox"</span> wicket:id=<span class="java&#45;quote">"subscribeList"</span>/&#62;
				&#60;/div&#62;
			&#60;/div&#62;
		&#60;/div&#62;	
	&#60;input type=<span class="java&#45;quote">"submit"</span> value=<span class="java&#45;quote">"Save"</span>/&#62;
&#60;/form&#62;</pre></div><p class="paragraph"/><strong class="bold">Java code:</strong><p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">public</span> HomePage(<span class="java&#45;keyword">final</span> PageParameters parameters) &#123;
    	RegistrationInfo registrtionInfo = <span class="java&#45;keyword">new</span> RegistrationInfo();
    	registrtionInfo.setSubscribeList(<span class="java&#45;keyword">true</span>);<p class="paragraph"/>    	Form form = <span class="java&#45;keyword">new</span> Form(<span class="java&#45;quote">"form"</span>, 
    			<span class="java&#45;keyword">new</span> CompoundPropertyModel&#60;RegistrationInfo&#62;(registrtionInfo));<p class="paragraph"/>    	form.add(<span class="java&#45;keyword">new</span> TextField(<span class="java&#45;quote">"name"</span>));
	form.add(<span class="java&#45;keyword">new</span> TextField(<span class="java&#45;quote">"surname"</span>));
	form.add(<span class="java&#45;keyword">new</span> TextField(<span class="java&#45;quote">"address"</span>));
	form.add(<span class="java&#45;keyword">new</span> TextField(<span class="java&#45;quote">"email"</span>));
	form.add(<span class="java&#45;keyword">new</span> CheckBox(<span class="java&#45;quote">"subscribeList"</span>));<p class="paragraph"/>	add(form);
&#125;</pre></div><p class="paragraph"/>Please note that the checkbox will be initially selected because we have set to true the subscribe flag during the model object creation (with instruction registrtionInfo.setSubscribeList(true)):<p class="paragraph"/><img border="0" class="center" src="../img/subscribe-checkbox-set.png"></img><p class="paragraph"/><h3>Working with grouped checkboxes</h3><p class="paragraph"/>When we need to display a given number of options with checkboxes, we can use the <code>org.apache.wicket.markup.html.form.CheckBoxMultipleChoice</code> component. For example, If our options are a list of strings, we can display them in this way:<p class="paragraph"/><strong class="bold">HTML:</strong><p class="paragraph"/><div class="code"><pre>&#60;div wicket:id=<span class="java&#45;quote">"checkGroup"</span>&#62;
		&#60;input type=<span class="java&#45;quote">"checkbox"</span>/&#62;It will be replaced by the actual checkboxes&#8230;
&#60;/div&#62;</pre></div><p class="paragraph"/><strong class="bold">Java code:</strong><p class="paragraph"/><div class="code"><pre>List&#60;<span class="java&#45;object">String</span>&#62; fruits = Arrays.asList(<span class="java&#45;quote">"apple"</span>, <span class="java&#45;quote">"strawberry"</span>, <span class="java&#45;quote">"watermelon"</span>); 
form.add(<span class="java&#45;keyword">new</span> CheckBoxMultipleChoice(<span class="java&#45;quote">"checkGroup"</span>, <span class="java&#45;keyword">new</span> ListModel&#60;<span class="java&#45;object">String</span>&#62;(<span class="java&#45;keyword">new</span>  
								 ArrayList&#60;<span class="java&#45;object">String</span>&#62;()), fruits));</pre></div><p class="paragraph"/><strong class="bold">Screenshot:</strong><p class="paragraph"/><img border="0" class="center" src="../img/grouped-checkbox.png"></img><p class="paragraph"/>This component can be attached to a &#60;div&#62; tag or to a &#60;span&#62; tag. No specific content is required for this tag as it will be populated with the actual checkboxes. Since this component allows multiple selection, its model object is a list. In the example above we have used model class <code>org.apache.wicket.model.util.ListModel</code> which is specifically designed to wrap a List object.<p class="paragraph"/>By default CheckBoxMultipleChoice inserts a &#60;br/&#62; tag as suffix after each option. We can configure both the suffix and the prefix used by the component with the setPrefix and setSuffix methods.<p class="paragraph"/>When our options are more complex objects than simple strings, we can render them using an IChoiceRender, as we did for DropDownChoice in paragraph 9.4:<p class="paragraph"/><strong class="bold">HTML:</strong><p class="paragraph"/><div class="code"><pre>&#60;div wicket:id=<span class="java&#45;quote">"checkGroup"</span>&#62;
		&#60;input type=<span class="java&#45;quote">"checkbox"</span>/&#62;It will be replaced by actual checkboxes&#8230;
&#60;/div&#62;</pre></div><p class="paragraph"/><strong class="bold">Java code:</strong><p class="paragraph"/><div class="code"><pre>Person john = <span class="java&#45;keyword">new</span> Person(<span class="java&#45;quote">"John"</span>, <span class="java&#45;quote">"Smith"</span>);
Person bob = <span class="java&#45;keyword">new</span> Person(<span class="java&#45;quote">"Bob"</span>, <span class="java&#45;quote">"Smith"</span>);
Person jill = <span class="java&#45;keyword">new</span> Person(<span class="java&#45;quote">"Jill"</span>, <span class="java&#45;quote">"Smith"</span>);
List&#60;Person&#62; theSmiths = Arrays.asList(john, bob, jill); 
ChoiceRenderer render = <span class="java&#45;keyword">new</span> ChoiceRenderer(<span class="java&#45;quote">"name"</span>);
     	form.add(<span class="java&#45;keyword">new</span> CheckBoxMultipleChoice(<span class="java&#45;quote">"checkGroup"</span>, <span class="java&#45;keyword">new</span> ListModel&#60;<span class="java&#45;object">String</span>&#62;(<span class="java&#45;keyword">new</span> ArrayList&#60;<span class="java&#45;object">String</span>&#62;()),   
                                    theSmiths, render));</pre></div><p class="paragraph"/><strong class="bold">Screenshot:</strong><p class="paragraph"/><img border="0" class="center" src="../img/grouped-checkbox2.png"></img><p class="paragraph"/><h3>How to implement a "Select all" checkbox</h3><p class="paragraph"/>A nice feature we can offer to users when we have a group of checkboxes is a “special” checkbox which selects/unselects all the other options of the group:<p class="paragraph"/><img border="0" class="center" src="../img/select-all-checkbox.png"></img><p class="paragraph"/>Wicket comes with a couple of utility components that make it easy to implement such a feature. They are CheckboxMultipleChoiceSelector and CheckBoxSelector classes, both inside package <code>org.apache.wicket.markup.html.form</code>. The difference between these two components is that the first works with an instance of CheckBoxMultipleChoice while the second takes in input a list of CheckBox objects:<p class="paragraph"/><div class="code"><pre>/&#42; CheckboxMultipleChoiceSelector usage: &#42;/<p class="paragraph"/>CheckBoxMultipleChoice checkGroup;
//checkGroup initialization&#8230;
CheckboxMultipleChoiceSelector cbmcs = <span class="java&#45;keyword">new</span> CheckboxMultipleChoiceSelector(<span class="java&#45;quote">"id"</span>, checkGroup);<p class="paragraph"/>/&#42; CheckBoxSelector usage: &#42;/<p class="paragraph"/>CheckBox checkBox1, checkBox2, checkBox3;
//checks initialization&#8230;
CheckBoxSelector cbmcs = <span class="java&#45;keyword">new</span> CheckBoxSelector(<span class="java&#45;quote">"id"</span>, checkBox1, checkBox2, checkBox3);</pre></div><p class="paragraph"/><h3>Working with grouped radio buttons</h3><p class="paragraph"/>For groups of radio buttons we can use the <code>org.apache.wicket.markup.html.form.RadioChoice</code> component which works in much the same way as CheckBoxMultipleChoice:<p class="paragraph"/><strong class="bold">HTML:</strong><p class="paragraph"/><div class="code"><pre>&#60;div wicket:id=<span class="java&#45;quote">"radioGroup"</span>&#62;
	&#60;input type=<span class="java&#45;quote">"radio"</span>/&#62;It will be replaced by actual radio buttons&#8230;
&#60;/div&#62;</pre></div><p class="paragraph"/><strong class="bold">Java code:</strong><p class="paragraph"/><div class="code"><pre>List&#60;<span class="java&#45;object">String</span>&#62; fruits = Arrays.asList(<span class="java&#45;quote">"apple"</span>, <span class="java&#45;quote">"strawberry"</span>, <span class="java&#45;quote">"watermelon"</span>); 
form.add(<span class="java&#45;keyword">new</span> RadioChoice(<span class="java&#45;quote">"radioGroup"</span>, Model.of(<span class="java&#45;quote">""</span>), fruits));</pre></div><p class="paragraph"/><strong class="bold">Screenshot:</strong><p class="paragraph"/><img border="0" class="center" src="../img/grouped-radiobutton.png"></img><p class="paragraph"/>Just like CheckBoxMultipleChoice, this component provides the setPrefix and setSuffix methods to configure the prefix and suffix for our options and it supports IChoiceRender as well. In addition, RadioChoice provides the wantOnSelectionChangedNotifications() method to notify the web server when the selected option changes (this is the same method seen for DropDownChoice in paragraph 9.4).


<h2 id="forms2_12">12.12 Selecting multiple values with ListMultipleChoices and Palette</h2>
<p class="paragraph"/>Checkboxes work well when we have a small amount of options to display, but they quickly become chaotic as the number of options increases. To overcome this limit we can use the &#60;select&#62; tag switching it to multiple-choice mode with attribute multiple="multiple":<p class="paragraph"/><img border="0" class="center" src="../img/list-multiple-choices.png"></img><p class="paragraph"/>Now the user can select multiple options by holding down Ctrl key (or Command key for Mac) and selecting them.<p class="paragraph"/>To work with multiple choice list Wicket provides the <code>org.apache.wicket.markup.html.form.ListMultipleChoice</code> component:<p class="paragraph"/><strong class="bold">HTML:</strong><p class="paragraph"/><div class="code"><pre>&#60;select wicket:id=<span class="java&#45;quote">"fruits"</span>&#62;
	&#60;option&#62;choice 1&#60;/option&#62;
	&#60;option&#62;choice 2&#60;/option&#62;
&#60;/select&#62;</pre></div><p class="paragraph"/><strong class="bold">Java code:</strong><p class="paragraph"/><div class="code"><pre>List&#60;<span class="java&#45;object">String</span>&#62; fruits = Arrays.asList(<span class="java&#45;quote">"apple"</span>, <span class="java&#45;quote">"strawberry"</span>, <span class="java&#45;quote">"watermelon"</span>); 
form.add(<span class="java&#45;keyword">new</span> ListMultipleChoice(<span class="java&#45;quote">"fruits"</span>, <span class="java&#45;keyword">new</span> ListModel&#60;<span class="java&#45;object">String</span>&#62;(<span class="java&#45;keyword">new</span> ArrayList&#60;<span class="java&#45;object">String</span>&#62;()), fruits));</pre></div><p class="paragraph"/><strong class="bold">Screenshot:</strong><p class="paragraph"/><img border="0" class="center" src="../img/list-multiple-choices2.png"></img><p class="paragraph"/>This component must be bound to a &#60;select&#62; tag but the attribute multiple="multiple" is not required as it will automatically be added by the component.<p class="paragraph"/>The number of visible rows can be set with the setMaxRows(int maxRows) method.<p class="paragraph"/><h3>Component Palette</h3><p class="paragraph"/>While multiple choice list solves the problem of handling a big number of multiple choices, it is not much intuitive for end users. That's why desktop GUIs have introduced a more complex component which can be generally referred to as multi select transfer component (it doesn't have an actual official name):<p class="paragraph"/><img border="0" class="center" src="../img/multi-select-transfer-component.png"></img><p class="paragraph"/>This kind of component is composed by two multiple-choice lists, one on the left displaying the available options and the other one on the right displaying the selected options. User can move options from a list to another by double clicking on them or using the buttons placed between the two list.<p class="paragraph"/>Built-in <code>org.apache.wicket.extensions.markup.html.form.palette.Palette</code> component provides an out-of-the-box implementation of a multi select transfer component. It works in a similar way to ListMultipleChoice:<p class="paragraph"/><strong class="bold">HTML:</strong><p class="paragraph"/><div class="code"><pre>&#60;div wicket:id=<span class="java&#45;quote">"palette"</span>&#62;
   Select will be replaced by the actual content&#8230;
	   &#60;select multiple=<span class="java&#45;quote">"multiple"</span>&#62;
     &#60;option&#62;option1&#60;/option&#62;
     &#60;option&#62;option2&#60;/option&#62;
     &#60;option&#62;option3&#60;/option&#62;
&#60;/div&#62;</pre></div><p class="paragraph"/><strong class="bold">Java code:</strong><p class="paragraph"/><div class="code"><pre>Person john = <span class="java&#45;keyword">new</span> Person(<span class="java&#45;quote">"John"</span>, <span class="java&#45;quote">"Smith"</span>);
Person bob = <span class="java&#45;keyword">new</span> Person(<span class="java&#45;quote">"Bob"</span>, <span class="java&#45;quote">"Smith"</span>);
Person jill = <span class="java&#45;keyword">new</span> Person(<span class="java&#45;quote">"Jill"</span>, <span class="java&#45;quote">"Smith"</span>);
Person andrea = <span class="java&#45;keyword">new</span> Person(<span class="java&#45;quote">"Andrea"</span>, <span class="java&#45;quote">"Smith"</span>);<p class="paragraph"/>List&#60;Person&#62; theSmiths = Arrays.asList(john, bob, jill, andrea); 
ChoiceRenderer render = <span class="java&#45;keyword">new</span> ChoiceRenderer(<span class="java&#45;quote">"name"</span>);<p class="paragraph"/>form.add(<span class="java&#45;keyword">new</span> Palette(<span class="java&#45;quote">"palette"</span>, Model.of(<span class="java&#45;keyword">new</span> ArrayList&#60;<span class="java&#45;object">String</span>&#62;()), <span class="java&#45;keyword">new</span> ListModel&#60;<span class="java&#45;object">String</span>&#62; (theSmiths), render, 5, <span class="java&#45;keyword">true</span>));</pre></div><p class="paragraph"/><strong class="bold">Screenshot:</strong><p class="paragraph"/><img border="0" class="center" src="../img/multi-select-transfer-component-wicket.png"></img><p class="paragraph"/>The last two parameters of the Palette's constructor (an integer value and a boolean value) are, respectively, the number of visible rows for the two lists and a flag to choose if we want to display the two optional buttons which move selected options up and down. The descriptions of the two lists (“Available” and “Selected”) can be customized providing two resources with keys palette.available and palette.selected.<p class="paragraph"/>The markup of this component uses a number of CSS classes which can be extended/overriden to customize the style of the component. We can find these classes and see which tags they decorate in the default markup file of the component:<p class="paragraph"/><div class="code"><pre>&#60;table cellspacing=<span class="java&#45;quote">"0"</span> cellpadding=<span class="java&#45;quote">"2"</span> class=<span class="java&#45;quote">"palette"</span>&#62;
&#60;tr&#62;
	&#60;td class=<span class="java&#45;quote">"header headerAvailable"</span>&#62;&#60;span wicket:id=<span class="java&#45;quote">"availableHeader"</span>&#62;&#91;available header&#93;&#60;/span&#62;&#60;/td&#62;
	&#60;td&#62;&#38;&#35;160;&#60;/td&#62;
	&#60;td class=<span class="java&#45;quote">"header headerSelected"</span>&#62;&#60;span wicket:id=<span class="java&#45;quote">"selectedHeader"</span>&#62;&#91;selected header&#93;&#60;/span&#62;                                           
        &#60;/td&#62; 
&#60;/tr&#62;
&#60;tr&#62;
	&#60;td class=<span class="java&#45;quote">"pane choices"</span>&#62;
		&#60;select wicket:id=<span class="java&#45;quote">"choices"</span> class=<span class="java&#45;quote">"choicesSelect"</span>&#62;&#91;choices&#93;&#60;/select&#62;	
	&#60;/td&#62;
	&#60;td class=<span class="java&#45;quote">"buttons"</span>&#62;
		&#60;button type=<span class="java&#45;quote">"button"</span> wicket:id=<span class="java&#45;quote">"addButton"</span> class=<span class="java&#45;quote">"button add"</span>&#62;&#60;div/&#62; 
               &#60;/button&#62;&#60;br/&#62;
		&#60;button type=<span class="java&#45;quote">"button"</span> wicket:id=<span class="java&#45;quote">"removeButton"</span> class=<span class="java&#45;quote">"button remove"</span>&#62;&#60;div/&#62; 
               &#60;/button&#62;&#60;br/&#62;
		&#60;button type=<span class="java&#45;quote">"button"</span> wicket:id=<span class="java&#45;quote">"moveUpButton"</span> class=<span class="java&#45;quote">"button up"</span>&#62;&#60;div/&#62;  
               &#60;/button&#62;&#60;br/&#62;
		&#60;button type=<span class="java&#45;quote">"button"</span> wicket:id=<span class="java&#45;quote">"moveDownButton"</span> class=<span class="java&#45;quote">"button down"</span>&#62;&#60;div/&#62;  
               &#60;/button&#62;&#60;br/&#62;
	&#60;/td&#62;
	&#60;td class=<span class="java&#45;quote">"pane selection"</span>&#62;
		&#60;select class=<span class="java&#45;quote">"selectionSelect"</span> wicket:id=<span class="java&#45;quote">"selection"</span>&#62;&#91;selection&#93;&#60;/select&#62;	
	&#60;/td&#62;
&#60;/tr&#62;
&#60;/table&#62;</pre></div>


<h2 id="forms2_13">12.13 Summary</h2>

Forms are the standard solution to let users interact with our web applications. In this chapter we have seen the three steps involved with the form processing workflow in Wicket. We have started looking at form validation and feedback messages generation, then we have seen how Wicket converts input values into Java objects and vice versa.<p class="paragraph"/>In the second part of the chapter we learnt how to build reusable form components and how to  implement a stateless form. We have ended the chapter with an overview of the built-in form components needed to handle standard input form elements like checkboxes, radio buttons and multiple selections lists.<p class="paragraph"/>



                <div style="clear:both;margin-top:15px;"></div>
                
                    <div class="toc-item prev-left"><a href="../guide/modelsforms.html">&lt;&lt; <strong>11</strong><span>Wicket models and forms</span></a></div>
                
                    <div class="toc-item next-right"><a href="../guide/repeaters.html"><strong>13</strong><span>Displaying multiple items with repeaters</span> >></a></div>
                
                <div style="clear:both"></div>
            </div>
        </td>
        <td id="col2">
            <div class="local clearfix">
                <div class="local-title">
                    <a href="../guide/index.html" target="mainFrame">Quick Reference</a>
                    <span class="toggle">(<a href="#" onclick="localToggle(); return false;">hide</a>)</span>
                </div>
                <div class="menu">
                    
                </div>
            </div>
        </td>
    </tr>
</table>

<div id="footer">
    
Copyright &copy; 2013-2014 — <a href="http://www.apache.org/" target="_blank">The Apache Software Foundation</a> 
                      — <b style="color:#E8590A !important;">(Generated on: 2014-09-09)</b>

    
</div>

<script type="text/javascript" src="../js/docs.js"></script>

</body>
</html>
