<!DOCTYPE html>
<html>
<head>
    <title>Apache Wicket - Ajax Counter</title>

	<link rel="stylesheet" href="/css/screen.css" type="text/css" media="screen" />

    <!--[if lt ie 7]>
	<link rel="stylesheet" href="/css/ie.css" type="text/css" media="screen" />
    <![endif]-->
    <link rel="shortcut icon" href="/favicon.ico" type="image/vnd.microsoft.icon" />
	<link rel="alternate" type="application/atom+xml" href="/atom.xml" />
	<meta http-equiv="content-type" content="text/html;charset=utf-8" />
</head>
<body>
<div id="container">
    <div id="content">
        <div id="header"><a href="/"><h1 id="logo"><span>Apache Wicket</span></h1></a></div>
		<div id="navigation">
	<h5><a name="Navigation-Wicket"></a>Meet Wicket</h5>
	<ul>
		<li>
			<a href="/" title="Index">Home</a>
		</li>
		<li>
			<a href="/meet/introduction.html" title="Introduction">Introduction</a>
		</li>
		<li>
			<a href="/meet/features.html" title="Features">Features</a>
		</li>
		<li>
			<a href="/meet/buzz.html" title="Buzz">Buzz</a>
		</li>
		<li>
			<a href="/meet/vision.html" title="Vision">Vision</a>
		</li>
		<li>
			<a href="/meet/blogs.html" title="Blogs">Blogs</a>
		</li>
	</ul>
	<h5>
		<a name="Navigation-GettingStarted" id="Navigation-GettingStarted"></a>Get Started
	</h5>
	<ul>
		<li>
			<a href="/start/download.html" title="Download Wicket">Download Wicket</a>
		</li>
		<li>
			<a href="/start/quickstart.html" title="Getting started via a Maven Archetype">Quickstart</a>
		</li>
		<li>
			<a href="http://www.jweekend.com/dev/LegUp" rel="nofollow">More archetypes</a>
		</li>
		<li>
			<a href="/help" title="Get help">Get help</a>
		</li>
		<li>
			<a href="/help/email.html" title="Wicket Mailing Lists">Mailing Lists</a>
		</li>
	</ul>
	<h5>
		<a name="Navigation-Documentation" id="Navigation-Documentation"></a>Learn
	</h5>
	<ul>
		<li>
			<a href="/start/userguide.html" title="User Guide">User Guide</a>
		</li>
		<li>
			<a href="/learn/examples" title="Examples">Examples</a>
		</li>
		<li>
			<a href="http://www.wicket-library.com/wicket-examples/compref/">Components</a>
		</li>
		<li>
			<a href="/learn/projects/" title="Projects extending basic Wicket">Projects</a>
		</li>
		<li>
			<a href="https://cwiki.apache.org/confluence/display/WICKET">Wiki</a>
		</li>
		<li>
			<a href="https://cwiki.apache.org/confluence/display/WICKET/Reference+library">Reference guide</a>
		</li>
		<li>
			<a href="/learn/books" title="Books">Books</a>
		</li>
		<li>
			<a href="/learn/ides.html" title="IDEs">IDEs</a>
		</li>
	</ul>
	<h5>
		<a name="Navigation-Releases" id="Navigation-Releases"></a>Releases
	</h5>
	<ul>
		<li>
			<a href="http://www.apache.org/dyn/closer.cgi/wicket/6.19.0">Wicket 6.19</a>
		</li>
		<li>
			<a href="http://www.apache.org/dyn/closer.cgi/wicket/1.5.13">Wicket 1.5</a>
		</li>
		<li>
			<a href="http://www.apache.org/dyn/closer.cgi/wicket/1.4.23">Wicket 1.4</a>
		</li>
		<li>
			<a href="http://www.apache.org/dyn/closer.cgi/wicket/1.3.7">Wicket 1.3</a>
		</li>
		<li>
			<a href="http://wicket.sf.net/wicket-1.2" class="external-link" rel="nofollow">Wicket 1.2</a>
		</li>
		<li>
			<a href="http://wicket.sf.net/wicket-1.1" class="external-link" rel="nofollow">Wicket 1.1</a>
		</li>
		<li>
			<a href="http://wicket.sf.net/wicket-1.0" class="external-link" rel="nofollow">Wicket 1.0</a>
		</li>
	</ul>
	<h5>
		<a name="Navigation-Docs" id="Navigation-Docs"></a>API Docs
	</h5>
	<ul>
		<li>
			<a href="http://ci.apache.org/projects/wicket/apidocs/6.x/" title="JavaDocs of Apache Wicket 6.x">Wicket 6.x</a>
		</li>
		<li>
			<a href="http://ci.apache.org/projects/wicket/apidocs/1.5.x/" title="JavaDocs of Apache Wicket 1.5.x">Wicket 1.5</a>
		</li>
		<li>
			<a href="http://ci.apache.org/projects/wicket/apidocs/1.4.x" title="JavaDocs of Apache Wicket 1.4.x">Wicket 1.4</a>
		</li>
		<li>
			<a href="http://ci.apache.org/projects/wicket/apidocs/1.3.x" title="JavaDocs of Apache Wicket 1.3.x">Wicket 1.3</a>
		</li>
	</ul>
	<h5>Wicket 7.x</h5>
	<ul>
		<li>
			<a href="http://www.apache.org/dyn/closer.cgi/wicket/7.0.0-M5">Download M5</a>
		</li>
		<li>
			<a href="https://cwiki.apache.org/confluence/display/WICKET/Migration+to+Wicket+7.0">Migration guide</a>
		</li>
		<li>
			<a href="http://ci.apache.org/projects/wicket/apidocs/7.x/" title="JavaDocs of Apache Wicket 7.x">API Docs 7.x</a>
		</li>
	</ul>
	<h5>
		<a name="Navigation-Developers" id="Navigation-Developers"></a>Contribute
	</h5>
	<ul>
		<li>
			<a href="/contribute/write.html" title="Writing documentation">Writing docs</a>
		</li>
		<li>
			<a href="/contribute/build.html" title="Building from SVN">Build Wicket</a>
		</li>
		<li>
			<a href="/contribute/patch.html" title="Provide a patch">Provide a patch</a>
		</li>
		<li>
			<a href="/contribute/release.html" title="Release Wicket">Release Wicket</a>
		</li>
		<li>
			<a href="https://fisheye6.atlassian.com/browse/wicket-git" title="Git Overview" class="external-link" rel="nofollow">Fisheye</a>
		</li>
	</ul>
	<h5>
		<a name="Navigation-Apache" id="Navigation-Apache"></a>Apache
	</h5>
	<ul>
		<li>
			<a href="http://www.apache.org/" class="external-link" rel="nofollow">Apache</a>
		</li>
		<li>
			<a href="http://www.apache.org/licenses/" class="external-link" rel="nofollow">License</a>
		</li>
		<li>
			<a href="http://www.apache.org/foundation/sponsorship.html" class="external-link" rel="nofollow">Sponsorship</a>
		</li>
		<li>
			<a href="http://apache.org/foundation/thanks.html" class="external-link" rel="nofollow">Thanks</a>
		</li>
		<li>
			<a href="/apache/friends.html" title="Apache projects using Wicket">Friends</a>
		</li>
	</ul>
</div>

		<div id="contentbody">
			<h1>Ajax Counter</h1>
			<p>This example shows you how to use Wicket’s Ajax behaviors and components by
building a simple counter that updates through Ajax link clicks.</p>

<p>In all the Wicket examples, you have to put all files in the same package
directory. This means putting the markup files and the java files next to one
another. It is possible to alter this behavior, but that is beyond the scope
of this example. The only exception is the obligatory <code>web.xml</code> file which
should reside in the <code>WEB-INF/</code> directory of your web application root
folder.</p>

<p>In this example we assume you already have read and understood the other
examples which give you information on the structure and nature of Wicket
applications. Specifically read and understand the <a href="helloworld.html">Hello, World
example</a>.</p>

<h2 id="counter-page">Counter page</h2>

<p>First we’ll create a page that just counts the number of times a link has been clicked. In the following markup you’ll see a link and a label.</p>

<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;#&quot;</span> <span class="na">wicket:id=</span><span class="s">&quot;link&quot;</span><span class="nt">&gt;</span>click me<span class="nt">&lt;/a&gt;</span>
    <span class="nt">&lt;p&gt;</span>
        Counter: <span class="nt">&lt;span</span> <span class="na">wicket:id=</span><span class="s">&quot;counter&quot;</span><span class="nt">&gt;</span>nr of times<span class="nt">&lt;/span&gt;</span>
    <span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></div>

<p>The link component will refresh the page and the label will replace the text
‘nr of times’ with the count. Take a look at the following Java file to see
how it works on the Java side:</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="n">wicket</span><span class="o">.</span><span class="na">quickstart</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">wicket.Component</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">wicket.markup.html.basic.Label</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">wicket.markup.html.link.Link</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">wicket.model.Model</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Index</span> <span class="kd">extends</span> <span class="n">QuickStartPage</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Index</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">Model</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">model</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Model</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;()</span> <span class="o">{</span>
            <span class="kd">private</span> <span class="kt">int</span> <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

            <span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getObject</span><span class="o">()</span> <span class="o">{</span>
                <span class="k">return</span> <span class="n">counter</span><span class="o">++;</span>
            <span class="o">}</span>
        <span class="o">};</span>
        <span class="n">add</span><span class="o">(</span><span class="k">new</span> <span class="nf">Link</span><span class="o">(</span><span class="s">&quot;link&quot;</span><span class="o">)</span> <span class="o">{</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">()</span> <span class="o">{</span>
                <span class="c1">// do nothing.</span>
            <span class="o">}</span>
        <span class="o">});</span>
        <span class="n">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Label</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;(</span><span class="s">&quot;counter&quot;</span><span class="o">,</span> <span class="n">model</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></div>

<p>In this class we created a <code>Model</code> subclass that increases its counter
everytime the <code>getObject</code> method gets called, and returns its value. We set
this model on the label component, so that each time the label gets rendered
the counter gets increased.</p>

<p>The link doesn’t do anything, just listen to the requests and update the
page. If you run this code in your application (download the Quickstart
project and copy/paste the code in the homepage for a quick experience).</p>

<p>The page gets fully refreshed with each link click. That is not very web 2.0,
so let’s make it more modern by adding some Ajax stuff.</p>

<h2 id="adding-ajax">Adding Ajax</h2>

<p>To make this a more modern UI we’ll have to change a couple of things. First
we need to make the link an Ajax link. Wicket provides several types of Ajax
links, but the best one for our purposes is the <code>AjaxFallbackLink</code>, as it
provides a fallback to a normal request in case no Ajax is available.</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="n">wicket</span><span class="o">.</span><span class="na">quickstart</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">wicket.Component</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">wicket.ajax.AjaxRequestTarget</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">wicket.ajax.markup.html.AjaxFallbackLink</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">wicket.markup.html.basic.Label</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">wicket.model.Model</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Index</span> <span class="kd">extends</span> <span class="n">QuickStartPage</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Index</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">Model</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">model</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Model</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;()</span> <span class="o">{</span>
            <span class="kd">private</span> <span class="kt">int</span> <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

            <span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getObject</span><span class="o">()</span> <span class="o">{</span>
                <span class="k">return</span> <span class="n">counter</span><span class="o">++;</span>
            <span class="o">}</span>
        <span class="o">};</span>
        <span class="n">add</span><span class="o">(</span><span class="k">new</span> <span class="nf">AjaxFallbackLink</span><span class="o">(</span><span class="s">&quot;link&quot;</span><span class="o">)</span> <span class="o">{</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="n">AjaxRequestTarget</span> <span class="n">target</span><span class="o">)</span> <span class="o">{</span>
                <span class="c1">// add the components that need to be updated to </span>
                <span class="c1">// the target</span>
            <span class="o">}</span>
        <span class="o">});</span>
        <span class="n">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Label</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;(</span><span class="s">&quot;counter&quot;</span><span class="o">,</span> <span class="n">model</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></div>

<p>As you can see, the <code>Link</code> has been replaced with the <code>AjaxFallbackLink</code>, and the
<code>onClick</code> method now takes a new argument: the <code>AjaxRequestTarget</code>. If you want a
component to be updated in the Ajax request, you’ll have to add them to the
target. So let’s alter the file to make it possible to add the label to the
request target.</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="n">wicket</span><span class="o">.</span><span class="na">quickstart</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">wicket.Component</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">wicket.ajax.AjaxRequestTarget</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">wicket.ajax.markup.html.AjaxFallbackLink</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">wicket.markup.html.basic.Label</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">wicket.model.Model</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Index</span> <span class="kd">extends</span> <span class="n">QuickStartPage</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Index</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">Model</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">model</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Model</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;()</span> <span class="o">{</span>
            <span class="kd">private</span> <span class="kt">int</span> <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

            <span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getObject</span><span class="o">()</span> <span class="o">{</span>
                <span class="k">return</span> <span class="n">counter</span><span class="o">++;</span>
            <span class="o">}</span>
        <span class="o">};</span>
        <span class="kd">final</span> <span class="n">Label</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">label</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Label</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;(</span><span class="s">&quot;counter&quot;</span><span class="o">,</span> <span class="n">model</span><span class="o">);</span>
        <span class="n">label</span><span class="o">.</span><span class="na">setOutputMarkupId</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
        <span class="n">add</span><span class="o">(</span><span class="k">new</span> <span class="nf">AjaxFallbackLink</span><span class="o">(</span><span class="s">&quot;link&quot;</span><span class="o">)</span> <span class="o">{</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="n">AjaxRequestTarget</span> <span class="n">target</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">target</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                    <span class="c1">// target is only available in an Ajax request</span>
                    <span class="n">target</span><span class="o">.</span><span class="na">addComponent</span><span class="o">(</span><span class="n">label</span><span class="o">);</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">});</span>
        <span class="n">add</span><span class="o">(</span><span class="n">label</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></div>

<p>We’ve moved the instantiation of the label to the beginning of the page
constructor and made a local, final variable. This way we can reference the
label in the event handler of the link component.</p>

<p>We also had to call <code>setOutputMarkupId(true)</code> on the label to be able to
update the component when the request is returned to the client browser. If
we don’t, Wicket will not know how to update the markup in the client.</p>

<p>If you put this code into your page’s class, then you’ll have a working Ajax
updating counter.</p>

<h2 id="summary">Summary</h2>

<p>Working with Ajax and Wicket using the standard Wicket libraries doesn’t
require a degree in JavaScript. Even better, you don’t necessarily need to
update your markup file to work with Ajax. In this (simple) example we were
able to add Ajax behavior to the page without touching the markup file.</p>

<p>The most important lesson here is that in order to update components using
Ajax is that you need to add those components to the <code>AjaxRequestTarget</code> and
that the components that are to be updated in that request, should have
<code>setOutputMarkupId(true)</code>.</p>

		</div>
        <div id="clearer"></div>
		<div id="footer"><span>
Copyright &copy; 2015 &mdash; The Apache Software Foundation. Apache Wicket,
Wicket, Apache, the Apache feather logo, and the Apache Wicket project logo
are trademarks of The Apache Software Foundation. All other marks mentioned
may be trademarks or registered trademarks of their respective owners.
</span></div>

    </div>
</div>
</body>
</html>
